<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>DockerCommandLineInterface | William&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="docker常用命令一览">
<meta name="author" content="deemoprobe">
<link rel="canonical" href="https://deemoprobe.github.io/posts/tech/docker/dockercli/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5a3abd3998ef4439a1a2f08ffdef0d650d48e3674f8f880f1e60bde49717df7a.css" integrity="sha256-Wjq9OZjvRDmhovCP/e8NZQ1I42dPj4gPHmC95JcX33o=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
        onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://deemoprobe.github.io/img/bear.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://deemoprobe.github.io/img/bear.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://deemoprobe.github.io/img/bear.gif">
<link rel="apple-touch-icon" href="https://deemoprobe.github.io/img/bear.gif">
<link rel="mask-icon" href="https://deemoprobe.github.io/img/bear.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script defer src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>


<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<meta property="og:title" content="DockerCommandLineInterface" />
<meta property="og:description" content="docker常用命令一览" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://deemoprobe.github.io/posts/tech/docker/dockercli/" />
<meta property="og:image" content="https://deemoprobe.github.io/img/docker.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-26T14:52:26+08:00" />
<meta property="article:modified_time" content="2023-04-26T14:52:26+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://deemoprobe.github.io/img/docker.png" />
<meta name="twitter:title" content="DockerCommandLineInterface"/>
<meta name="twitter:description" content="docker常用命令一览"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [

        {
          "@type": "ListItem",
          "position":  1 ,
          "name": "📚文章",
          "item": "https://deemoprobe.github.io/posts/"
        },

        {
          "@type": "ListItem",
          "position":  2 ,
          "name": "👨🏻‍💻 技术",
          "item": "https://deemoprobe.github.io/posts/tech/"
        },

        {
          "@type": "ListItem",
          "position":  3 ,
          "name": "Docker",
          "item": "https://deemoprobe.github.io/posts/tech/docker/"
        }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "DockerCommandLineInterface",
      "item": "https://deemoprobe.github.io/posts/tech/docker/dockercli/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "DockerCommandLineInterface",
  "name": "DockerCommandLineInterface",
  "description": "docker常用命令一览",
  "keywords": [
    ""
  ],
  "articleBody": "本文整理了docker常用的一些命令。包括镜像命令，容器命令，日志查看，容器的高级操作以及从容器传输文件到宿主机。\n常用 # 查看docker版本 docker version # 查看docker系统信息 docker info # 实时监控容器的运行情况 docker stats # 查看容器或镜像的底层信息 docker inspect ID/NAME # 查看容器中进程情况 docker top ID/NAME # 查看容器中进程的日志 docker logs ID/NAME # 进入某个容器系统 docker exec -it ID/NAME bash 详细用法 Usage: docker COMMAND A self-sufficient runtime for containers Commands: attach Attach local standard input, output, and error streams to a running container build Build an image from a Dockerfile commit Create a new image from a container changes cp Copy files/folders between a container and the local filesystem create Create a new container diff Inspect changes to files or directories on a container filesystem events Get real time events from the server exec Run a command in a running container export Export a container filesystem as a tar archive history Show the history of an image images List images import Import the contents from a tarball to create a filesystem image info Display system-wide information inspect Return low-level information on Docker objects kill Kill one or more running containers load Load an image from a tar archive or STDIN login Log in to a Docker registry logout Log out from a Docker registry logs Fetch the logs of a container pause Pause all processes within one or more containers port List port mappings or a specific mapping for the container ps List containers pull Pull an image or a repository from a registry push Push an image or a repository to a registry rename Rename a container restart Restart one or more containers rm Remove one or more containers rmi Remove one or more images run Run a command in a new container save Save one or more images to a tar archive (streamed to STDOUT by default) search Search the Docker Hub for images start Start one or more stopped containers stats Display a live stream of container(s) resource usage statistics stop Stop one or more running containers tag Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE top Display the running processes of a container unpause Unpause all processes within one or more containers update Update configuration of one or more containers version Show the Docker version information wait Block until one or more containers stop, then print their exit codes 镜像命令 REPOSITORY: 镜像的仓库源 TAG: 镜像标签 IMAGE ID: 镜像ID CREATED: 镜像已创建时间 SIZE: 镜像大小 docker images Usage: docker images [OPTIONS] [REPOSITORY[:TAG]] List images Options: -a, --all Show all images (default hides intermediate images) --digests Show digests -f, --filter filter Filter output based on conditions provided --format string Pretty-print images using a Go template --no-trunc Do not truncate output -q, --quiet Only show image IDs # 查看镜像 [root@demo ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE tomcat latest fb5657adc892 12 days ago 680MB hello-world latest feb5d9fea6a5 3 months ago 13.3kB centos latest 5d0da3dc9764 3 months ago 231MB # 查看所有镜像 docker images -a # 查看镜像ID docker images -q # 查看所有镜像ID docker images -qa docker search Usage: docker search [OPTIONS] [IMAGE] Search the Docker Hub for images Options: -f, --filter filter Filter output based on conditions provided --format string Pretty-print search using a Go template --limit int Max number of search results (default 25) --no-trunc Do not truncate output # 从Docker Hub上查询已存在镜像 [root@demo ~]# docker search nginx NAME DESCRIPTION STARS OFFICIAL AUTOMATED nginx Official build of Nginx. 16062 [OK] jwilder/nginx-proxy Automated Nginx reverse proxy for docker con… 2105 [OK] richarvey/nginx-php-fpm Container running Nginx + PHP-FPM capable of… 819 [OK] jc21/nginx-proxy-manager Docker container for managing Nginx proxy ho… 303 linuxserver/nginx An Nginx container, brought to you by LinuxS… 161 tiangolo/nginx-rtmp Docker image with Nginx using the nginx-rtmp… 148 [OK] ... # 根据stars数目来搜索IMAGE # 查看800星以上的nginx镜像 [root@demo ~]# docker search nginx -f stars=800 NAME DESCRIPTION STARS OFFICIAL AUTOMATED nginx Official build of Nginx. 16062 [OK] jwilder/nginx-proxy Automated Nginx reverse proxy for docker con… 2105 [OK] richarvey/nginx-php-fpm Container running Nginx + PHP-FPM capable of… 819 [OK] # 搜索800星以上的nginx镜像，并且不切割摘要信息（摘要全部显示） [root@demo ~]# docker search nginx --no-trunc -f stars=800 NAME DESCRIPTION STARS OFFICIAL AUTOMATED nginx Official build of Nginx. 16062 [OK] jwilder/nginx-proxy Automated Nginx reverse proxy for docker containers 2105 [OK] richarvey/nginx-php-fpm Container running Nginx + PHP-FPM capable of pulling application code from git 819 [OK] docker pull Usage: docker pull [OPTIONS] NAME[:TAG|@DIGEST] Pull an image or a repository from a registry Options: -a, --all-tags Download all tagged images in the repository --disable-content-trust Skip image verification (default true) --platform string Set platform if server is multi-platform capable -q, --quiet Suppress verbose output # 从配置好的仓库拉取镜像, 未配置的话默认从Docker Hub上获取 docker pull IMAGE \u003c==\u003e docker pull IMAGE:latest # 拉取指定版本镜像 docker pull IMAGE:TAG docker rmi Usage: docker rmi [OPTIONS] IMAGE [IMAGE...] Remove one or more images Options: -f, --force Force removal of the image --no-prune Do not delete untagged parents # 删除最新版本镜像 docker rmi IMAGE \u003c==\u003e docker rmi IMAGE:latest # 删除指定版本镜像 docker rmi IMAGE:TAG # -f 强制删除镜像(可删除多层镜像) docker rmi -f IMAGE # 指定镜像ID进行删除 docker rmi -f IMAGE_ID # 删除多个镜像 docker rmi -f IMAGE1 IMAGE2 IMAGE3 # 删除所有镜像 docker rmi -f $(docker images -qa) # 实例 [root@demo ~]# docker rmi hello-world Untagged: hello-world:latest Untagged: hello-world@sha256:2498fce14358aa50ead0cc6c19990fc6ff866ce72aeb5546e1d59caac3d0d60f Deleted: sha256:feb5d9fea6a5e9606aa995e879d862b825965ba48de054caab5ef356dc6b3412 Deleted: sha256:e07ee1baac5fae6a26f30cabfe54a36d3402f96afda318fe0a96cec4ca393359 dangling悬挂镜像 仓库名、标签均为的镜像被称为悬挂镜像，这种镜像已经失去了存在的价值。出现悬挂镜像原因一般是在docker pull *:latest时产生。当新版本发布后重新pull，镜像名会被新镜像所占用，旧镜像的名字会变成。\n# 删除悬挂镜像（dangling），-f不显示提示确认信息，直接强制删除 [root@harbor ~]# docker image prune WARNING! This will remove all dangling images. Are you sure you want to continue? [y/N] # 删除所有未使用的镜像（即未运行容器的镜像），-f不显示提示确认信息，直接强制删除 [root@harbor ~]# docker image prune -a WARNING! This will remove all images without at least one container associated to them. Are you sure you want to continue? [y/N] 容器命令 docker run docker run [OPTIONS] IMAGE [COMMAND] [ARG...] OPTIONS字段说明: - --name 自定义容器名 - -d 后台运行容器 - -it 新建伪终端交互运行容器 - -P 随机分配端口映射 - -p 指定端口映射, 有以下四种方式 - ip:hostPort:containerPort - ip::containerPort - hostPort:containerPort - containerPort # 先获取镜像 [root@demo ~]# docker pull centos [root@demo ~]# docker images REPOSITORY TAG IMAGE ID CREATED SIZE tomcat latest fb5657adc892 12 days ago 680MB centos latest 5d0da3dc9764 3 months ago 231MB # 启动运行CentOS容器(本地有该镜像就直接启动, 没有就自动拉取) [root@demo ~]# docker run -it centos [root@f75fd428066f /]# cat /etc/redhat-release CentOS Linux release 8.4.2105 [root@f75fd428066f /]# exit [root@demo ~]# docker run -it --namecentos8 centos [root@dd16aaf5cbcd /]# exit [root@demo ~]# docker ps -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES dd16aaf5cbcd centos \"/bin/bash\" 58 seconds ago Exited (0) 52 seconds ago centos8 f75fd428066f centos \"/bin/bash\" 3 minutes ago Exited (0) 2 minutes ago silly_engelbart # 为nginx镜像随机分配端口映射 [root@demo ~]# docker run -it -P nginx:1.18.0 Unable to find image 'nginx:1.18.0' locally 1.18.0: Pulling from library/nginx f7ec5a41d630: Pull complete 0b20d28b5eb3: Pull complete 1576642c9776: Pull complete c12a848bad84: Pull complete 03f221d9cf00: Pull complete Digest: sha256:e90ac5331fe095cea01b121a3627174b2e33e06e83720e9a934c7b8ccc9c55a0 Status: Downloaded newer image for nginx:1.18.0 /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration /docker-entrypoint.sh: Looking for bash scripts in /docker-entrypoint.d/ /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh 10-listen-on-ipv6-by-default.sh: Getting the checksum of /etc/nginx/conf.d/default.conf 10-listen-on-ipv6-by-default.sh: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh /docker-entrypoint.sh: Configuration complete; ready for start up # 另起一个终端，查看分配的端口 [root@demo ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 97c9f5f24db2 nginx:1.18.0 \"/docker-entrypoint.…\" 42 seconds ago Up 40 seconds 0.0.0.0:49153-\u003e80/tcp, :::49153-\u003e80/tcp jovial_burnell # 指定端口映射 [root@demo ~]# docker run -it --name nginx-web -p 8080:80 nginx:1.18.0 /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration /docker-entrypoint.sh: Looking for bash scripts in /docker-entrypoint.d/ /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh 10-listen-on-ipv6-by-default.sh: Getting the checksum of /etc/nginx/conf.d/default.conf 10-listen-on-ipv6-by-default.sh: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh /docker-entrypoint.sh: Configuration complete; ready for start up # 另起一个终端查看容器信息 [root@demo ~]# docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 7e243e46f6f6 nginx:1.18.0 \"/docker-entrypoint.…\" 23 seconds ago Up 22 seconds 0.0.0.0:8080-\u003e80/tcp, :::8080-\u003e80/tcp nginx-web # 访问nginx [root@demo ~]# curl localhost:8080 \u003c!DOCTYPE html\u003e Welcome to nginx! Welcome to nginx! If you see this page, the nginx web server is successfully installed and working. Further configuration is required.\nFor online documentation and support please refer to ",
  "wordCount" : "4959",
  "inLanguage": "en",
  "image":"https://deemoprobe.github.io/img/docker.png","datePublished": "2023-04-26T14:52:26+08:00",
  "dateModified": "2023-04-26T14:52:26+08:00",
  "author":[{
    "@type": "Person",
    "name": "deemoprobe"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://deemoprobe.github.io/posts/tech/docker/dockercli/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "William's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://deemoprobe.github.io/img/bear.gif"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    (function () {
        let  arr,reg = new RegExp("(^| )"+"change-themes"+"=([^;]*)(;|$)");
        if(arr = document.cookie.match(reg)) {
        } else {
            if (new Date().getHours() >= 19 || new Date().getHours() < 6) {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            }
        }
    })()

    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://deemoprobe.github.io/" accesskey="h" title="William&#39;s Blog (Alt + H)">
            <img src="https://deemoprobe.github.io/img/bear.gif" alt="logo" aria-label="logo"
                 height="35">William&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://deemoprobe.github.io/" title="🏠 主页">
                <span>🏠 主页</span>
                </a>
            </li>
            <li>
                <a href="https://deemoprobe.github.io/tags" title="🎨 标签">
                <span>🎨 标签</span>
                </a>
            </li>
            <li>
                <a href="https://deemoprobe.github.io/archives/" title="📈 归档">
                <span>📈 归档</span>
                </a>
            </li>
            <li>
                <a href="https://deemoprobe.github.io/tools" title="🪁 工具">
                <span>🪁 工具</span>
                </a>
            </li>
            <li>
                <a href="https://deemoprobe.github.io/search" title="🔍 搜索 (Alt &#43; /)" accesskey=/>
                <span>🔍 搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }
</style>

<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            
            <h1 class="post-title">
                DockerCommandLineInterface
            </h1>
            <div class="post-description">
                docker常用命令一览
            </div>
            <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2023-04-26
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>4959字
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>10分钟
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>deemoprobe
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="https://deemoprobe.github.io/tags/docker/" style="color: var(--secondary)!important;">docker</a>
            </span>
        </span>
    </span>
</span>
<span style="opacity: 0.8;">
                    <span id="post_meta_style_7">
                        &nbsp;&nbsp;
                        <span class="fa fa-eye" ></span>
                        <span>
                            <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                            &nbsp;&nbsp;
                        </span>
                    </span>
                    
                </span>

</div>
        </header> 
<figure class="entry-cover1"><img style="zoom:;" loading="lazy" src="https://deemoprobe.github.io/img/docker.png" alt="">
    
</figure><aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">文章目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%b8%b8%e7%94%a8" aria-label="常用">常用</a></li>
                <li>
                    <a href="#%e8%af%a6%e7%bb%86%e7%94%a8%e6%b3%95" aria-label="详细用法">详细用法</a></li>
                <li>
                    <a href="#%e9%95%9c%e5%83%8f%e5%91%bd%e4%bb%a4" aria-label="镜像命令">镜像命令</a><ul>
                        
                <li>
                    <a href="#docker-images" aria-label="docker images">docker images</a></li>
                <li>
                    <a href="#docker-search" aria-label="docker search">docker search</a></li>
                <li>
                    <a href="#docker-pull" aria-label="docker pull">docker pull</a></li>
                <li>
                    <a href="#docker-rmi" aria-label="docker rmi">docker rmi</a></li>
                <li>
                    <a href="#dangling%e6%82%ac%e6%8c%82%e9%95%9c%e5%83%8f" aria-label="dangling悬挂镜像">dangling悬挂镜像</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%ae%b9%e5%99%a8%e5%91%bd%e4%bb%a4" aria-label="容器命令">容器命令</a><ul>
                        
                <li>
                    <a href="#docker-run" aria-label="docker run">docker run</a></li>
                <li>
                    <a href="#docker-ps" aria-label="docker ps">docker ps</a></li>
                <li>
                    <a href="#%e5%ae%b9%e5%99%a8%e5%90%af%e5%81%9c" aria-label="容器启停">容器启停</a></li>
                <li>
                    <a href="#%e5%88%a0%e9%99%a4%e5%ae%b9%e5%99%a8" aria-label="删除容器">删除容器</a></li>
                <li>
                    <a href="#%e8%bf%9b%e5%85%a5%e6%ad%a3%e5%9c%a8%e8%bf%90%e8%a1%8c%e7%9a%84%e5%ae%b9%e5%99%a8" aria-label="进入正在运行的容器">进入正在运行的容器</a></li>
                <li>
                    <a href="#%e9%80%80%e5%87%ba%e5%ae%b9%e5%99%a8" aria-label="退出容器">退出容器</a></li>
                <li>
                    <a href="#%e5%ae%b9%e5%99%a8%e5%91%bd%e4%bb%a4%e9%ab%98%e7%ba%a7%e6%93%8d%e4%bd%9c" aria-label="容器命令高级操作">容器命令高级操作</a></li>
                <li>
                    <a href="#%e9%95%9c%e5%83%8f%e7%9a%84%e5%ae%9a%e5%88%b6" aria-label="镜像的定制">镜像的定制</a></li>
                <li>
                    <a href="#%e9%ab%98%e7%ba%a7%e5%91%bd%e4%bb%a4" aria-label="高级命令">高级命令</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
            const id = encodeURI(element.getAttribute('id')).toLowerCase();
            if (element === activeElement){
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
            } else {
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
            }
        })
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
        <div class="post-content"><p>本文整理了docker常用的一些命令。包括镜像命令，容器命令，日志查看，容器的高级操作以及从容器传输文件到宿主机。</p>
<h2 id="常用">常用<a hidden class="anchor" aria-hidden="true" href="#常用">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 查看docker版本</span>
</span></span><span style="display:flex;"><span>docker version
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看docker系统信息</span>
</span></span><span style="display:flex;"><span>docker info
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 实时监控容器的运行情况</span>
</span></span><span style="display:flex;"><span>docker stats
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看容器或镜像的底层信息</span>
</span></span><span style="display:flex;"><span>docker inspect ID/NAME
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看容器中进程情况</span>
</span></span><span style="display:flex;"><span>docker top ID/NAME
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看容器中进程的日志</span>
</span></span><span style="display:flex;"><span>docker logs ID/NAME
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 进入某个容器系统</span>
</span></span><span style="display:flex;"><span>docker exec -it ID/NAME bash
</span></span></code></pre></div><h2 id="详细用法">详细用法<a hidden class="anchor" aria-hidden="true" href="#详细用法">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Usage:  docker COMMAND
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>A self-sufficient runtime <span style="color:#66d9ef">for</span> containers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Commands:
</span></span><span style="display:flex;"><span>  attach      Attach local standard input, output, and error streams to a running container
</span></span><span style="display:flex;"><span>  build       Build an image from a Dockerfile
</span></span><span style="display:flex;"><span>  commit      Create a new image from a container changes
</span></span><span style="display:flex;"><span>  cp          Copy files/folders between a container and the local filesystem
</span></span><span style="display:flex;"><span>  create      Create a new container
</span></span><span style="display:flex;"><span>  diff        Inspect changes to files or directories on a container filesystem
</span></span><span style="display:flex;"><span>  events      Get real time events from the server
</span></span><span style="display:flex;"><span>  exec        Run a command in a running container
</span></span><span style="display:flex;"><span>  export      Export a container filesystem as a tar archive
</span></span><span style="display:flex;"><span>  history     Show the history of an image
</span></span><span style="display:flex;"><span>  images      List images
</span></span><span style="display:flex;"><span>  import      Import the contents from a tarball to create a filesystem image
</span></span><span style="display:flex;"><span>  info        Display system-wide information
</span></span><span style="display:flex;"><span>  inspect     Return low-level information on Docker objects
</span></span><span style="display:flex;"><span>  kill        Kill one or more running containers
</span></span><span style="display:flex;"><span>  load        Load an image from a tar archive or STDIN
</span></span><span style="display:flex;"><span>  login       Log in to a Docker registry
</span></span><span style="display:flex;"><span>  logout      Log out from a Docker registry
</span></span><span style="display:flex;"><span>  logs        Fetch the logs of a container
</span></span><span style="display:flex;"><span>  pause       Pause all processes within one or more containers
</span></span><span style="display:flex;"><span>  port        List port mappings or a specific mapping <span style="color:#66d9ef">for</span> the container
</span></span><span style="display:flex;"><span>  ps          List containers
</span></span><span style="display:flex;"><span>  pull        Pull an image or a repository from a registry
</span></span><span style="display:flex;"><span>  push        Push an image or a repository to a registry
</span></span><span style="display:flex;"><span>  rename      Rename a container
</span></span><span style="display:flex;"><span>  restart     Restart one or more containers
</span></span><span style="display:flex;"><span>  rm          Remove one or more containers
</span></span><span style="display:flex;"><span>  rmi         Remove one or more images
</span></span><span style="display:flex;"><span>  run         Run a command in a new container
</span></span><span style="display:flex;"><span>  save        Save one or more images to a tar archive <span style="color:#f92672">(</span>streamed to STDOUT by default<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  search      Search the Docker Hub <span style="color:#66d9ef">for</span> images
</span></span><span style="display:flex;"><span>  start       Start one or more stopped containers
</span></span><span style="display:flex;"><span>  stats       Display a live stream of container<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> resource usage statistics
</span></span><span style="display:flex;"><span>  stop        Stop one or more running containers
</span></span><span style="display:flex;"><span>  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE
</span></span><span style="display:flex;"><span>  top         Display the running processes of a container
</span></span><span style="display:flex;"><span>  unpause     Unpause all processes within one or more containers
</span></span><span style="display:flex;"><span>  update      Update configuration of one or more containers
</span></span><span style="display:flex;"><span>  version     Show the Docker version information
</span></span><span style="display:flex;"><span>  wait        Block <span style="color:#66d9ef">until</span> one or more containers stop, <span style="color:#66d9ef">then</span> print their exit codes
</span></span></code></pre></div><h2 id="镜像命令">镜像命令<a hidden class="anchor" aria-hidden="true" href="#镜像命令">#</a></h2>
<ul>
<li>REPOSITORY: 镜像的仓库源</li>
<li>TAG: 镜像标签</li>
<li>IMAGE ID: 镜像ID</li>
<li>CREATED: 镜像已创建时间</li>
<li>SIZE: 镜像大小</li>
</ul>
<h3 id="docker-images">docker images<a hidden class="anchor" aria-hidden="true" href="#docker-images">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Usage:  docker images <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>REPOSITORY<span style="color:#f92672">[</span>:TAG<span style="color:#f92672">]]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>List images
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>  -a, --all             Show all images <span style="color:#f92672">(</span>default hides intermediate images<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --digests         Show digests
</span></span><span style="display:flex;"><span>  -f, --filter filter   Filter output based on conditions provided
</span></span><span style="display:flex;"><span>      --format string   Pretty-print images using a Go template
</span></span><span style="display:flex;"><span>      --no-trunc        Do not truncate output
</span></span><span style="display:flex;"><span>  -q, --quiet           Only show image IDs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看镜像</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker images</span>
</span></span><span style="display:flex;"><span>REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
</span></span><span style="display:flex;"><span>tomcat        latest    fb5657adc892   <span style="color:#ae81ff">12</span> days ago    680MB
</span></span><span style="display:flex;"><span>hello-world   latest    feb5d9fea6a5   <span style="color:#ae81ff">3</span> months ago   13.3kB
</span></span><span style="display:flex;"><span>centos        latest    5d0da3dc9764   <span style="color:#ae81ff">3</span> months ago   231MB
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看所有镜像</span>
</span></span><span style="display:flex;"><span>docker images -a
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看镜像ID</span>
</span></span><span style="display:flex;"><span>docker images -q
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看所有镜像ID</span>
</span></span><span style="display:flex;"><span>docker images -qa
</span></span></code></pre></div><h3 id="docker-search">docker search<a hidden class="anchor" aria-hidden="true" href="#docker-search">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Usage:  docker search <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>IMAGE<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Search the Docker Hub <span style="color:#66d9ef">for</span> images
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>  -f, --filter filter   Filter output based on conditions provided
</span></span><span style="display:flex;"><span>      --format string   Pretty-print search using a Go template
</span></span><span style="display:flex;"><span>      --limit int       Max number of search results <span style="color:#f92672">(</span>default 25<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --no-trunc        Do not truncate output
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 从Docker Hub上查询已存在镜像</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker search nginx</span>
</span></span><span style="display:flex;"><span>NAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
</span></span><span style="display:flex;"><span>nginx                             Official build of Nginx.                        <span style="color:#ae81ff">16062</span>     <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>       
</span></span><span style="display:flex;"><span>jwilder/nginx-proxy               Automated Nginx reverse proxy <span style="color:#66d9ef">for</span> docker con…   <span style="color:#ae81ff">2105</span>                 <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>richarvey/nginx-php-fpm           Container running Nginx + PHP-FPM capable of…   <span style="color:#ae81ff">819</span>                  <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>jc21/nginx-proxy-manager          Docker container <span style="color:#66d9ef">for</span> managing Nginx proxy ho…   <span style="color:#ae81ff">303</span>                  
</span></span><span style="display:flex;"><span>linuxserver/nginx                 An Nginx container, brought to you by LinuxS…   <span style="color:#ae81ff">161</span>                  
</span></span><span style="display:flex;"><span>tiangolo/nginx-rtmp               Docker image with Nginx using the nginx-rtmp…   <span style="color:#ae81ff">148</span>                  <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 根据stars数目来搜索IMAGE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看800星以上的nginx镜像</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker search nginx -f stars=800</span>
</span></span><span style="display:flex;"><span>NAME                      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
</span></span><span style="display:flex;"><span>nginx                     Official build of Nginx.                        <span style="color:#ae81ff">16062</span>     <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>       
</span></span><span style="display:flex;"><span>jwilder/nginx-proxy       Automated Nginx reverse proxy <span style="color:#66d9ef">for</span> docker con…   <span style="color:#ae81ff">2105</span>                 <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>richarvey/nginx-php-fpm   Container running Nginx + PHP-FPM capable of…   <span style="color:#ae81ff">819</span>                  <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 搜索800星以上的nginx镜像，并且不切割摘要信息（摘要全部显示）</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker search nginx --no-trunc -f stars=800</span>
</span></span><span style="display:flex;"><span>NAME                      DESCRIPTION                                                                      STARS     OFFICIAL   AUTOMATED
</span></span><span style="display:flex;"><span>nginx                     Official build of Nginx.                                                         <span style="color:#ae81ff">16062</span>     <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>       
</span></span><span style="display:flex;"><span>jwilder/nginx-proxy       Automated Nginx reverse proxy <span style="color:#66d9ef">for</span> docker containers                              <span style="color:#ae81ff">2105</span>                 <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>richarvey/nginx-php-fpm   Container running Nginx + PHP-FPM capable of pulling application code from git   <span style="color:#ae81ff">819</span>                  <span style="color:#f92672">[</span>OK<span style="color:#f92672">]</span>
</span></span></code></pre></div><h3 id="docker-pull">docker pull<a hidden class="anchor" aria-hidden="true" href="#docker-pull">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Usage:  docker pull <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> NAME<span style="color:#f92672">[</span>:TAG|@DIGEST<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Pull an image or a repository from a registry
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>  -a, --all-tags                Download all tagged images in the repository
</span></span><span style="display:flex;"><span>      --disable-content-trust   Skip image verification <span style="color:#f92672">(</span>default true<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --platform string         Set platform <span style="color:#66d9ef">if</span> server is multi-platform capable
</span></span><span style="display:flex;"><span>  -q, --quiet                   Suppress verbose output
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 从配置好的仓库拉取镜像, 未配置的话默认从Docker Hub上获取</span>
</span></span><span style="display:flex;"><span>docker pull IMAGE  &lt;<span style="color:#f92672">==</span>&gt;  docker pull IMAGE:latest
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 拉取指定版本镜像</span>
</span></span><span style="display:flex;"><span>docker pull IMAGE:TAG
</span></span></code></pre></div><h3 id="docker-rmi">docker rmi<a hidden class="anchor" aria-hidden="true" href="#docker-rmi">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Usage:  docker rmi <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> IMAGE <span style="color:#f92672">[</span>IMAGE...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Remove one or more images
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>  -f, --force      Force removal of the image
</span></span><span style="display:flex;"><span>      --no-prune   Do not delete untagged parents
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除最新版本镜像</span>
</span></span><span style="display:flex;"><span>docker rmi IMAGE  &lt;<span style="color:#f92672">==</span>&gt;  docker rmi IMAGE:latest
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除指定版本镜像</span>
</span></span><span style="display:flex;"><span>docker rmi IMAGE:TAG
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -f 强制删除镜像(可删除多层镜像)</span>
</span></span><span style="display:flex;"><span>docker rmi -f IMAGE
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 指定镜像ID进行删除</span>
</span></span><span style="display:flex;"><span>docker rmi -f IMAGE_ID
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除多个镜像</span>
</span></span><span style="display:flex;"><span>docker rmi -f IMAGE1 IMAGE2 IMAGE3
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除所有镜像</span>
</span></span><span style="display:flex;"><span>docker rmi -f <span style="color:#66d9ef">$(</span>docker images -qa<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 实例</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker rmi hello-world</span>
</span></span><span style="display:flex;"><span>Untagged: hello-world:latest
</span></span><span style="display:flex;"><span>Untagged: hello-world@sha256:2498fce14358aa50ead0cc6c19990fc6ff866ce72aeb5546e1d59caac3d0d60f
</span></span><span style="display:flex;"><span>Deleted: sha256:feb5d9fea6a5e9606aa995e879d862b825965ba48de054caab5ef356dc6b3412
</span></span><span style="display:flex;"><span>Deleted: sha256:e07ee1baac5fae6a26f30cabfe54a36d3402f96afda318fe0a96cec4ca393359
</span></span></code></pre></div><h3 id="dangling悬挂镜像">dangling悬挂镜像<a hidden class="anchor" aria-hidden="true" href="#dangling悬挂镜像">#</a></h3>
<p>仓库名、标签均为<none>的镜像被称为悬挂镜像，这种镜像已经失去了存在的价值。出现悬挂镜像原因一般是在<code>docker pull *:latest</code>时产生。当新版本发布后重新pull，镜像名会被新镜像所占用，旧镜像的名字会变成<none>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 删除悬挂镜像（dangling），-f不显示提示确认信息，直接强制删除</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@harbor ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker image prune</span>
</span></span><span style="display:flex;"><span>WARNING! This will remove all dangling images.
</span></span><span style="display:flex;"><span>Are you sure you want to <span style="color:#66d9ef">continue</span>? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除所有未使用的镜像（即未运行容器的镜像），-f不显示提示确认信息，直接强制删除</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@harbor ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker image prune -a</span>
</span></span><span style="display:flex;"><span>WARNING! This will remove all images without at least one container associated to them.
</span></span><span style="display:flex;"><span>Are you sure you want to <span style="color:#66d9ef">continue</span>? <span style="color:#f92672">[</span>y/N<span style="color:#f92672">]</span>
</span></span></code></pre></div><h2 id="容器命令">容器命令<a hidden class="anchor" aria-hidden="true" href="#容器命令">#</a></h2>
<h3 id="docker-run">docker run<a hidden class="anchor" aria-hidden="true" href="#docker-run">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> IMAGE <span style="color:#f92672">[</span>COMMAND<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>ARG...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OPTIONS字段说明:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- --name 自定义容器名
</span></span><span style="display:flex;"><span>- -d  后台运行容器
</span></span><span style="display:flex;"><span>- -it 新建伪终端交互运行容器
</span></span><span style="display:flex;"><span>- -P  随机分配端口映射
</span></span><span style="display:flex;"><span>- -p  指定端口映射, 有以下四种方式
</span></span><span style="display:flex;"><span>  - ip:hostPort:containerPort
</span></span><span style="display:flex;"><span>  - ip::containerPort
</span></span><span style="display:flex;"><span>  - hostPort:containerPort
</span></span><span style="display:flex;"><span>  - containerPort
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 先获取镜像</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker pull centos</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker images</span>
</span></span><span style="display:flex;"><span>REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
</span></span><span style="display:flex;"><span>tomcat       latest    fb5657adc892   <span style="color:#ae81ff">12</span> days ago    680MB
</span></span><span style="display:flex;"><span>centos       latest    5d0da3dc9764   <span style="color:#ae81ff">3</span> months ago   231MB
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 启动运行CentOS容器(本地有该镜像就直接启动, 没有就自动拉取)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -it centos</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@f75fd428066f /<span style="color:#f92672">]</span><span style="color:#75715e"># cat /etc/redhat-release </span>
</span></span><span style="display:flex;"><span>CentOS Linux release 8.4.2105
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@f75fd428066f /<span style="color:#f92672">]</span><span style="color:#75715e"># exit</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -it --namecentos8 centos</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@dd16aaf5cbcd /<span style="color:#f92672">]</span><span style="color:#75715e"># exit</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE     COMMAND       CREATED          STATUS                      PORTS     NAMES
</span></span><span style="display:flex;"><span>dd16aaf5cbcd   centos    <span style="color:#e6db74">&#34;/bin/bash&#34;</span>   <span style="color:#ae81ff">58</span> seconds ago   Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">52</span> seconds ago             centos8
</span></span><span style="display:flex;"><span>f75fd428066f   centos    <span style="color:#e6db74">&#34;/bin/bash&#34;</span>   <span style="color:#ae81ff">3</span> minutes ago    Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">2</span> minutes ago              silly_engelbart
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 为nginx镜像随机分配端口映射</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -it -P nginx:1.18.0</span>
</span></span><span style="display:flex;"><span>Unable to find image <span style="color:#e6db74">&#39;nginx:1.18.0&#39;</span> locally
</span></span><span style="display:flex;"><span>1.18.0: Pulling from library/nginx
</span></span><span style="display:flex;"><span>f7ec5a41d630: Pull complete 
</span></span><span style="display:flex;"><span>0b20d28b5eb3: Pull complete 
</span></span><span style="display:flex;"><span>1576642c9776: Pull complete 
</span></span><span style="display:flex;"><span>c12a848bad84: Pull complete 
</span></span><span style="display:flex;"><span>03f221d9cf00: Pull complete 
</span></span><span style="display:flex;"><span>Digest: sha256:e90ac5331fe095cea01b121a3627174b2e33e06e83720e9a934c7b8ccc9c55a0
</span></span><span style="display:flex;"><span>Status: Downloaded newer image <span style="color:#66d9ef">for</span> nginx:1.18.0
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: Looking <span style="color:#66d9ef">for</span> bash scripts in /docker-entrypoint.d/
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
</span></span><span style="display:flex;"><span>10-listen-on-ipv6-by-default.sh: Getting the checksum of /etc/nginx/conf.d/default.conf
</span></span><span style="display:flex;"><span>10-listen-on-ipv6-by-default.sh: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: Configuration complete; ready <span style="color:#66d9ef">for</span> start up
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 另起一个终端，查看分配的端口</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS          PORTS                                     NAMES
</span></span><span style="display:flex;"><span>97c9f5f24db2   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">42</span> seconds ago   Up <span style="color:#ae81ff">40</span> seconds   0.0.0.0:49153-&gt;80/tcp, :::49153-&gt;80/tcp   jovial_burnell
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 指定端口映射</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -it --name nginx-web -p 8080:80 nginx:1.18.0</span>
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: Looking <span style="color:#66d9ef">for</span> bash scripts in /docker-entrypoint.d/
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
</span></span><span style="display:flex;"><span>10-listen-on-ipv6-by-default.sh: Getting the checksum of /etc/nginx/conf.d/default.conf
</span></span><span style="display:flex;"><span>10-listen-on-ipv6-by-default.sh: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
</span></span><span style="display:flex;"><span>/docker-entrypoint.sh: Configuration complete; ready <span style="color:#66d9ef">for</span> start up
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 另起一个终端查看容器信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS          PORTS                                   NAMES
</span></span><span style="display:flex;"><span>7e243e46f6f6   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">23</span> seconds ago   Up <span style="color:#ae81ff">22</span> seconds   0.0.0.0:8080-&gt;80/tcp, :::8080-&gt;80/tcp   nginx-web
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 访问nginx</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># curl localhost:8080</span>
</span></span><span style="display:flex;"><span>&lt;!DOCTYPE html&gt;
</span></span><span style="display:flex;"><span>&lt;html&gt;
</span></span><span style="display:flex;"><span>&lt;head&gt;
</span></span><span style="display:flex;"><span>&lt;title&gt;Welcome to nginx!&lt;/title&gt;
</span></span><span style="display:flex;"><span>&lt;style&gt;
</span></span><span style="display:flex;"><span>    body <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        width: 35em;
</span></span><span style="display:flex;"><span>        margin: <span style="color:#ae81ff">0</span> auto;
</span></span><span style="display:flex;"><span>        font-family: Tahoma, Verdana, Arial, sans-serif;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>&lt;/style&gt;
</span></span><span style="display:flex;"><span>&lt;/head&gt;
</span></span><span style="display:flex;"><span>&lt;body&gt;
</span></span><span style="display:flex;"><span>&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
</span></span><span style="display:flex;"><span>&lt;p&gt;If you see this page, the nginx web server is successfully installed and
</span></span><span style="display:flex;"><span>working. Further configuration is required.&lt;/p&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;p&gt;For online documentation and support please refer to
</span></span><span style="display:flex;"><span>&lt;a href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://nginx.org/&#34;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
</span></span><span style="display:flex;"><span>Commercial support is available at
</span></span><span style="display:flex;"><span>&lt;a href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://nginx.com/&#34;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;p&gt;&lt;em&gt;Thank you <span style="color:#66d9ef">for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
</span></span><span style="display:flex;"><span>&lt;/body&gt;
</span></span><span style="display:flex;"><span>&lt;/html&gt;
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 在第一个终端可看到访问日志</span>
</span></span><span style="display:flex;"><span>172.17.0.1 - - <span style="color:#f92672">[</span>04/Jan/2022:01:08:26 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET / HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> <span style="color:#ae81ff">612</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;curl/7.29.0&#34;</span> <span style="color:#e6db74">&#34;-&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 浏览器访问</span>
</span></span></code></pre></div><p><img loading="lazy" src="https://deemoprobe.oss-cn-shanghai.aliyuncs.com/images/20201125144623.png" alt="20201125144623"  />
</p>
<h3 id="docker-ps">docker ps<a hidden class="anchor" aria-hidden="true" href="#docker-ps">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Usage:  docker ps <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>List containers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>  -a, --all             Show all containers <span style="color:#f92672">(</span>default shows just running<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  -f, --filter filter   Filter output based on conditions provided
</span></span><span style="display:flex;"><span>      --format string   Pretty-print containers using a Go template
</span></span><span style="display:flex;"><span>  -n, --last int        Show n last created containers <span style="color:#f92672">(</span>includes all states<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>default -1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  -l, --latest          Show the latest created container <span style="color:#f92672">(</span>includes all states<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --no-trunc        Do not truncate output
</span></span><span style="display:flex;"><span>  -q, --quiet           Only display container IDs
</span></span><span style="display:flex;"><span>  -s, --size            Display total file sizes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看在运行容器</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS         PORTS                                   NAMES
</span></span><span style="display:flex;"><span>7e243e46f6f6   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> minutes ago   Up <span style="color:#ae81ff">3</span> minutes   0.0.0.0:8080-&gt;80/tcp, :::8080-&gt;80/tcp   nginx-web
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看在运行容器ID</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -q</span>
</span></span><span style="display:flex;"><span>7e243e46f6f6
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看所有容器（包含已退出的容器）</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS                      PORTS                                   NAMES
</span></span><span style="display:flex;"><span>7e243e46f6f6   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> minutes ago    Up <span style="color:#ae81ff">3</span> minutes                0.0.0.0:8080-&gt;80/tcp, :::8080-&gt;80/tcp   nginx-web
</span></span><span style="display:flex;"><span>97c9f5f24db2   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">5</span> minutes ago    Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">4</span> minutes ago                                            jovial_burnell
</span></span><span style="display:flex;"><span>dd16aaf5cbcd   centos         <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">10</span> minutes ago   Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">10</span> minutes ago                                           centos8
</span></span><span style="display:flex;"><span>f75fd428066f   centos         <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">12</span> minutes ago   Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">11</span> minutes ago                                           silly_engelbart
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看所有容器ID（包含已退出的容器）</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -qa</span>
</span></span><span style="display:flex;"><span>7e243e46f6f6
</span></span><span style="display:flex;"><span>97c9f5f24db2
</span></span><span style="display:flex;"><span>dd16aaf5cbcd
</span></span><span style="display:flex;"><span>f75fd428066f
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看最近使用的两个容器</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -n 2</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS                     PORTS                                   NAMES
</span></span><span style="display:flex;"><span>7e243e46f6f6   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">5</span> minutes ago   Up <span style="color:#ae81ff">5</span> minutes               0.0.0.0:8080-&gt;80/tcp, :::8080-&gt;80/tcp   nginx-web
</span></span><span style="display:flex;"><span>97c9f5f24db2   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">7</span> minutes ago   Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">6</span> minutes ago                                           jovial_burnell
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看最近一次启动的容器</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -l</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS         PORTS                                   NAMES
</span></span><span style="display:flex;"><span>7e243e46f6f6   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">5</span> minutes ago   Up <span style="color:#ae81ff">5</span> minutes   0.0.0.0:8080-&gt;80/tcp, :::8080-&gt;80/tcp   nginx-web
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看容器的大小</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -s</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS         PORTS                                   NAMES       SIZE
</span></span><span style="display:flex;"><span>7e243e46f6f6   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">6</span> minutes ago   Up <span style="color:#ae81ff">6</span> minutes   0.0.0.0:8080-&gt;80/tcp, :::8080-&gt;80/tcp   nginx-web   1.12kB <span style="color:#f92672">(</span>virtual 133MB<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="容器启停">容器启停<a hidden class="anchor" aria-hidden="true" href="#容器启停">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 启动已停止的容器</span>
</span></span><span style="display:flex;"><span>docker start 容器名或ID
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 重启容器</span>
</span></span><span style="display:flex;"><span>docker restart 容器名或ID
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 停止容器</span>
</span></span><span style="display:flex;"><span>docker stop 容器名或ID
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 强制停止容器</span>
</span></span><span style="display:flex;"><span>docker kill 容器名或ID
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 实例</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS                      PORTS     NAMES
</span></span><span style="display:flex;"><span>7e243e46f6f6   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">7</span> minutes ago    Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">8</span> seconds ago              nginx-web
</span></span><span style="display:flex;"><span>97c9f5f24db2   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">9</span> minutes ago    Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">8</span> minutes ago              jovial_burnell
</span></span><span style="display:flex;"><span>dd16aaf5cbcd   centos         <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">14</span> minutes ago   Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">14</span> minutes ago             centos8
</span></span><span style="display:flex;"><span>f75fd428066f   centos         <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">16</span> minutes ago   Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">15</span> minutes ago             silly_engelbart
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker start 7e243e46f6f6</span>
</span></span><span style="display:flex;"><span>7e243e46f6f6
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS         PORTS                                   NAMES
</span></span><span style="display:flex;"><span>7e243e46f6f6   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">7</span> minutes ago   Up <span style="color:#ae81ff">4</span> seconds   0.0.0.0:8080-&gt;80/tcp, :::8080-&gt;80/tcp   nginx-web
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker stop nginx-web</span>
</span></span><span style="display:flex;"><span>nginx-web
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
</span></span></code></pre></div><h3 id="删除容器">删除容器<a hidden class="anchor" aria-hidden="true" href="#删除容器">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 删除已停止容器</span>
</span></span><span style="display:flex;"><span>docker rm 容器名或ID
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 强制删除(若在运行,也会强制停止后删除)</span>
</span></span><span style="display:flex;"><span>docker rm -f 容器名或ID
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除全部容器</span>
</span></span><span style="display:flex;"><span>docker rm -f <span style="color:#66d9ef">$(</span>docker ps -qa<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>or
</span></span><span style="display:flex;"><span>docker ps -qa | xargs docker rm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 实例</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker rm $(docker ps -qa)</span>
</span></span><span style="display:flex;"><span>7e243e46f6f6
</span></span><span style="display:flex;"><span>97c9f5f24db2
</span></span><span style="display:flex;"><span>dd16aaf5cbcd
</span></span><span style="display:flex;"><span>f75fd428066f
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -qa</span>
</span></span></code></pre></div><h3 id="进入正在运行的容器">进入正在运行的容器<a hidden class="anchor" aria-hidden="true" href="#进入正在运行的容器">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Usage:  docker exec <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> CONTAINER COMMAND <span style="color:#f92672">[</span>ARG...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Run a command in a running container
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>  -d, --detach               Detached mode: run command in the background
</span></span><span style="display:flex;"><span>      --detach-keys string   Override the key sequence <span style="color:#66d9ef">for</span> detaching a container
</span></span><span style="display:flex;"><span>  -e, --env list             Set environment variables
</span></span><span style="display:flex;"><span>      --env-file list        Read in a file of environment variables
</span></span><span style="display:flex;"><span>  -i, --interactive          Keep STDIN open even <span style="color:#66d9ef">if</span> not attached
</span></span><span style="display:flex;"><span>      --privileged           Give extended privileges to the command
</span></span><span style="display:flex;"><span>  -t, --tty                  Allocate a pseudo-TTY
</span></span><span style="display:flex;"><span>  -u, --user string          Username or UID <span style="color:#f92672">(</span>format: &lt;name|uid&gt;<span style="color:#f92672">[</span>:&lt;group|gid&gt;<span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>  -w, --workdir string       Working directory inside the container
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 进入正在运行的容器并启用交互</span>
</span></span><span style="display:flex;"><span>docker exec -it 容器ID /bin/bash
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 不进入正在运行的容器直接交互,比如查看根目录</span>
</span></span><span style="display:flex;"><span>docker exec -it 容器ID ls -al /
</span></span><span style="display:flex;"><span>exit <span style="color:#75715e"># 退出</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 实例</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 后台启一个nginx</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -itd --nametest_exec nginx</span>
</span></span><span style="display:flex;"><span>Unable to find image <span style="color:#e6db74">&#39;nginx:latest&#39;</span> locally
</span></span><span style="display:flex;"><span>latest: Pulling from library/nginx
</span></span><span style="display:flex;"><span>a2abf6c4d29d: Pull complete 
</span></span><span style="display:flex;"><span>a9edb18cadd1: Pull complete 
</span></span><span style="display:flex;"><span>589b7251471a: Pull complete 
</span></span><span style="display:flex;"><span>186b1aaa4aa6: Pull complete 
</span></span><span style="display:flex;"><span>b4df32aa5a72: Pull complete 
</span></span><span style="display:flex;"><span>a0bcbecc962e: Pull complete 
</span></span><span style="display:flex;"><span>Digest: sha256:0d17b565c37bcbd895e9d92315a05c1c3c9a29f762b011a10c54a66cd53c9b31
</span></span><span style="display:flex;"><span>Status: Downloaded newer image <span style="color:#66d9ef">for</span> nginx:latest
</span></span><span style="display:flex;"><span>864a1bdcf178ae110817a3d2f1d9cbf3b4f6d9bba0d7e477b971c403b5281e8a
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES
</span></span><span style="display:flex;"><span>864a1bdcf178   nginx     <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">28</span> seconds ago   Up <span style="color:#ae81ff">27</span> seconds   80/tcp    test_exec
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 进入容器</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker exec -it test_exec /bin/bash</span>
</span></span><span style="display:flex;"><span>root@864a1bdcf178:/# exit
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 不进入容器执行命令，查看/bin目录下文件数量</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker exec -it test_exec ls -al /bin | wc -l</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">72</span>
</span></span></code></pre></div><h3 id="退出容器">退出容器<a hidden class="anchor" aria-hidden="true" href="#退出容器">#</a></h3>
<p>exit（等价于Ctrl+D） 退出并关闭容器(适用于docker run命令启动的容器, docker exec 进入容器exit退出后不影响容器状态)</p>
<p>一般需要后台运行的容器可以使用-d先后台启动，需要交互时exec进入容器进行交互。</p>
<h3 id="容器命令高级操作">容器命令高级操作<a hidden class="anchor" aria-hidden="true" href="#容器命令高级操作">#</a></h3>
<p>docker单独启动容器作为守护进程(后台运行), 启动后<code>docker ps -a</code>会发现已经退出了<br>
原因是：docker容器运行机制决定,docker容器后台运行就必须要有一个前台进程,否则会自动退出<br>
所以要解决这个问题就是将要运行的进程以前台进程的形式运行（或者交互模式启动 -itd）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 启动容器作为守护进程,这样会直接退出</span>
</span></span><span style="display:flex;"><span>docker run -d 镜像名
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 后台运行并每两秒在前台输出一次hello</span>
</span></span><span style="display:flex;"><span>docker run -d centos /bin/sh -c <span style="color:#e6db74">&#34;while true;do echo hello;sleep 2;done&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看日志, 列出时间, 动态打印日志, 保留之前num行</span>
</span></span><span style="display:flex;"><span>docker logs -f -t --tail num 容器ID
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 实例</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 先删除所有容器</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker rm $(docker ps -qa) -f</span>
</span></span><span style="display:flex;"><span>f0b8817bb234
</span></span><span style="display:flex;"><span>864a1bdcf178
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 后台启动一个centos，发现启动后会直接退出</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -d centos</span>
</span></span><span style="display:flex;"><span>acfd747d7ec4a942374bb526d41d072fe4840e3ba3d1255e67bdee5c2399513a
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE     COMMAND       CREATED         STATUS                     PORTS     NAMES
</span></span><span style="display:flex;"><span>acfd747d7ec4   centos    <span style="color:#e6db74">&#34;/bin/bash&#34;</span>   <span style="color:#ae81ff">6</span> seconds ago   Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">6</span> seconds ago             dreamy_wilbur
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 加入前台进程的在运行</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -d centos /bin/sh -c &#34;while true;do echo hello;sleep 2;done&#34;</span>
</span></span><span style="display:flex;"><span>000da5e0a32581d4c65cb6a64292010f86feceac8ebea3f715f2d972fa7c7065
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS                      PORTS     NAMES
</span></span><span style="display:flex;"><span>000da5e0a325   centos    <span style="color:#e6db74">&#34;/bin/sh -c &#39;while t…&#34;</span>   <span style="color:#ae81ff">3</span> seconds ago    Up <span style="color:#ae81ff">2</span> seconds                          xenodochial_shamir
</span></span><span style="display:flex;"><span>acfd747d7ec4   centos    <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">52</span> seconds ago   Exited <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span> <span style="color:#ae81ff">52</span> seconds ago             dreamy_wilbur
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 每两秒打印一次</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker logs 000da5e0a325</span>
</span></span><span style="display:flex;"><span>hello
</span></span><span style="display:flex;"><span>hello
</span></span><span style="display:flex;"><span>hello
</span></span><span style="display:flex;"><span>hello
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看容器内运行的进程</span>
</span></span><span style="display:flex;"><span>docker top 容器ID
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker top 000da5e0a325</span>
</span></span><span style="display:flex;"><span>UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD
</span></span><span style="display:flex;"><span>root                <span style="color:#ae81ff">10408</span>               <span style="color:#ae81ff">10388</span>               <span style="color:#ae81ff">0</span>                   09:33               ?                   00:00:00            /bin/sh -c <span style="color:#66d9ef">while</span> true;<span style="color:#66d9ef">do</span> echo hello;sleep 2;<span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>root                <span style="color:#ae81ff">10549</span>               <span style="color:#ae81ff">10408</span>               <span style="color:#ae81ff">0</span>                   09:35               ?                   00:00:00            /usr/bin/coreutils --coreutils-prog-shebang<span style="color:#f92672">=</span>sleep /usr/bin/sleep <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 容器内传输数据到宿主机</span>
</span></span><span style="display:flex;"><span>docker cp 容器ID:/path /宿主机path
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 进入一个容器，在根目录下创建文件并拷贝到宿主机根目录</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker exec -it 000da5e0a325 /bin/bash</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@000da5e0a325 /<span style="color:#f92672">]</span><span style="color:#75715e"># echo test &gt;&gt; test.txt</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@000da5e0a325 /<span style="color:#f92672">]</span><span style="color:#75715e"># cat test.txt </span>
</span></span><span style="display:flex;"><span>test
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@000da5e0a325 /<span style="color:#f92672">]</span><span style="color:#75715e"># exit</span>
</span></span><span style="display:flex;"><span>exit
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker cp 000da5e0a325:/test.txt /</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># cat /test.txt </span>
</span></span><span style="display:flex;"><span>test
</span></span></code></pre></div><h3 id="镜像的定制">镜像的定制<a hidden class="anchor" aria-hidden="true" href="#镜像的定制">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 如果该容器内部做了更改，提交打包后更改也包含进去，以此完成镜像的定制</span>
</span></span><span style="display:flex;"><span>docker commit -a<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;作者名&#34;</span> -m<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;提交信息&#34;</span> 容器ID 定制后的镜像名
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 启动一个容器，自定义端口映射，基于nginx:1.18.0镜像</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -d -p 8080:80 --name nginx1.18.0 nginx:1.18.0</span>
</span></span><span style="display:flex;"><span>02c275a9254c7714d8187dc35efabf8859b245272b1ef101c4411b68aa85d9c3
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps --no-trunc</span>
</span></span><span style="display:flex;"><span>CONTAINER ID                                                       IMAGE          COMMAND                                                CREATED          STATUS          PORTS                                   NAMES
</span></span><span style="display:flex;"><span>02c275a9254c7714d8187dc35efabf8859b245272b1ef101c4411b68aa85d9c3   nginx:1.18.0   <span style="color:#e6db74">&#34;/docker-entrypoint.sh nginx -g &#39;daemon off;&#39;&#34;</span>         <span style="color:#ae81ff">29</span> seconds ago   Up <span style="color:#ae81ff">28</span> seconds   0.0.0.0:8080-&gt;80/tcp, :::8080-&gt;80/tcp   nginx1.18.0
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 定制新镜像并打上tag为1.18.0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker commit -a=&#34;deemoprobe&#34; -m=&#34;nginx:1.18.0 8080-&gt;80&#34; 02c275a9254c7714d8187dc35efabf8859b245272b1ef101c4411b68aa85d9c3 deemoprobe/nginx:1.18.0</span>
</span></span><span style="display:flex;"><span>sha256:00b7979f0210c4ebde226fb86d789a4caef7276b2d92304b3942ef34ce733a96
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看新的镜像已生成</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker images | grep deemoprobe</span>
</span></span><span style="display:flex;"><span>deemoprobe/nginx   1.18.0    00b7979f0210   <span style="color:#ae81ff">28</span> seconds ago   133MB
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 以提交到docker hub为例</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 首先要创建docker hub账户，然后建立一个新仓库</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 登陆docker hub</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker login</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Login Succeeded
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 推送</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker push deemoprobe/nginx:1.18.0</span>
</span></span><span style="display:flex;"><span>The push refers to repository <span style="color:#f92672">[</span>docker.io/deemoprobe/nginx<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>4fa6704c8474: Mounted from library/nginx 
</span></span><span style="display:flex;"><span>4fe7d87c8e14: Mounted from library/nginx 
</span></span><span style="display:flex;"><span>6fcbf7acaafd: Mounted from library/nginx 
</span></span><span style="display:flex;"><span>f3fdf88f1cb7: Mounted from library/nginx 
</span></span><span style="display:flex;"><span>7e718b9c0c8c: Mounted from library/nginx 
</span></span><span style="display:flex;"><span>1.18.0: digest: sha256:2db445abcd9b126654035448cada7817300d646a27380916a6b6445e8ede699b size: <span style="color:#ae81ff">1362</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># docker hub上就能查看到nginx镜像仓库，并且标签为1.18.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 拉下来查看</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker pull deemoprobe/nginx:1.18.0</span>
</span></span><span style="display:flex;"><span>1.18.0: Pulling from deemoprobe/nginx
</span></span><span style="display:flex;"><span>f7ec5a41d630: Already exists 
</span></span><span style="display:flex;"><span>0b20d28b5eb3: Already exists 
</span></span><span style="display:flex;"><span>1576642c9776: Already exists 
</span></span><span style="display:flex;"><span>c12a848bad84: Already exists 
</span></span><span style="display:flex;"><span>03f221d9cf00: Already exists 
</span></span><span style="display:flex;"><span>Digest: sha256:2db445abcd9b126654035448cada7817300d646a27380916a6b6445e8ede699b
</span></span><span style="display:flex;"><span>Status: Downloaded newer image <span style="color:#66d9ef">for</span> deemoprobe/nginx:1.18.0
</span></span><span style="display:flex;"><span>docker.io/deemoprobe/nginx:1.18.0
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker images deemoprobe/nginx:1.18.0</span>
</span></span><span style="display:flex;"><span>REPOSITORY         TAG       IMAGE ID       CREATED          SIZE
</span></span><span style="display:flex;"><span>deemoprobe/nginx   1.18.0    b5fd6cb4ca9e   <span style="color:#ae81ff">20</span> minutes ago   133MB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 或者说直接将拉取的镜像保存在自己的仓库里，可以直接打标签上传</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 比如拷贝cnych/ingress-nginx-defaultbackend镜像并上传至自己的DockerHub</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 前提是已经登陆成功</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-node01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker images | grep 1.5</span>
</span></span><span style="display:flex;"><span>cnych/ingress-nginx-defaultbackend                               1.5       b5af743e5984   <span style="color:#ae81ff">3</span> years ago     5.13MB
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-node01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker tag cnych/ingress-nginx-defaultbackend:1.5 deemoprobe/defaultbackend:1.5</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-node01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker push deemoprobe/defaultbackend:1.5</span>
</span></span><span style="display:flex;"><span>The push refers to repository <span style="color:#f92672">[</span>docker.io/deemoprobe/defaultbackend<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>b108d4968233: Mounted from cnych/ingress-nginx-defaultbackend 
</span></span><span style="display:flex;"><span>1.5: digest: sha256:4dc5e07c8ca4e23bddb3153737d7b8c556e5fb2f29c4558b7cd6e6df99c512c7 size: <span style="color:#ae81ff">528</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-node01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker images | grep 1.5</span>
</span></span><span style="display:flex;"><span>cnych/ingress-nginx-defaultbackend                               1.5       b5af743e5984   <span style="color:#ae81ff">3</span> years ago     5.13MB
</span></span><span style="display:flex;"><span>deemoprobe/defaultbackend                                        1.5       b5af743e5984   <span style="color:#ae81ff">3</span> years ago     5.13MB
</span></span></code></pre></div><h3 id="高级命令">高级命令<a hidden class="anchor" aria-hidden="true" href="#高级命令">#</a></h3>
<ul>
<li>docker run进阶</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 临时运行容器，用完即删不产生容器docker ps记录</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 临时开启容器查看镜像的WORKDIR</span>
</span></span><span style="display:flex;"><span>docker run -it --rm IMAGE pwd
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 临时开启容器进入查看镜像内容</span>
</span></span><span style="display:flex;"><span>docker run -it --rm IMAGE /bin/sh
</span></span></code></pre></div><ul>
<li>查看docker配置信息</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 查看容器详情信息的某个字段</span>
</span></span><span style="display:flex;"><span>docker inspect -f <span style="color:#e6db74">&#34;{{ .首字段.子字段 }}&#34;</span> &lt;ContainerNameOrId&gt;
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看容器IP地址</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker inspect -f &#34;{{ .NetworkSettings.IPAddress }}&#34; 38798985efb9</span>
</span></span><span style="display:flex;"><span>172.17.0.2
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看容器主机名</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker inspect -f &#34;{{ .Config.Hostname }}&#34; 38798985efb9</span>
</span></span><span style="display:flex;"><span>38798985efb9
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看开放的端口</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker inspect -f &#34;{{ .Config.ExposedPorts }}&#34; 38798985efb9</span>
</span></span><span style="display:flex;"><span>map<span style="color:#f92672">[</span>80/tcp:<span style="color:#f92672">{}]</span>
</span></span></code></pre></div><ul>
<li>查看网络</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 启动并开放nginx80端口，80端口映射到主机的1234端口</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -p 1234:80 -d nginx</span>
</span></span><span style="display:flex;"><span>03694540d34be5f69d951f15316dbdeae63fdc60a09e1da078273d5e15cb74ff
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps</span>
</span></span><span style="display:flex;"><span>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES
</span></span><span style="display:flex;"><span>03694540d34b        nginx               <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">4</span> seconds ago       Up <span style="color:#ae81ff">2</span> seconds        0.0.0.0:1234-&gt;80/tcp   nifty_williams
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看端口映射关系</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker port 03694540d34b 80</span>
</span></span><span style="display:flex;"><span>0.0.0.0:1234
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看nat规则</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># iptables -t nat -nL</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Chain DOCKER <span style="color:#f92672">(</span><span style="color:#ae81ff">2</span> references<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>target     prot opt source               destination
</span></span><span style="display:flex;"><span>RETURN     all  --  0.0.0.0/0            0.0.0.0/0
</span></span><span style="display:flex;"><span>DNAT       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:1234 to:172.17.0.3:80
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 若容器内部访问不了外网，检查ip_forward和SNAT/MASQUERADE</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 开启ip_forward</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># sysctl net.ipv4.ip_forward=1</span>
</span></span><span style="display:flex;"><span>net.ipv4.ip_forward <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看SNAT/MASQUERADE是否是ACCEPT</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@demo ~<span style="color:#f92672">]</span><span style="color:#75715e"># iptables -t nat -nL</span>
</span></span><span style="display:flex;"><span>Chain POSTROUTING <span style="color:#f92672">(</span>policy ACCEPT<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>target     prot opt source               destination
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 这条规则指定从容器内出来的包都要进行一次地址转换</span>
</span></span><span style="display:flex;"><span>MASQUERADE  all  --  172.17.0.0/16        0.0.0.0/0
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div>

        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="prev" href="https://deemoprobe.github.io/posts/tech/docker/dockerfilegrammer/">
    <span class="title">« 上一页</span>
    <br>
    <span>DockerfileGrammer</span>
  </a>
  <a class="next" href="https://deemoprobe.github.io/posts/tech/docker/docker/">
    <span class="title">下一页 »</span>
    <br>
    <span>Docker</span>
  </a>
</nav>

        </footer>
    </div>
</article>
</main>

<footer class="footer">
    
        <span id="runtime_span"></span>
        <script
            type="text/javascript">function show_runtime() { window.setTimeout("show_runtime()", 1000); X = new Date("1/1/2023 1:00:00"); Y = new Date(); T = (Y.getTime() - X.getTime()); M = 24 * 60 * 60 * 1000; a = T / M; A = Math.floor(a); b = (a - A) * 24; B = Math.floor(b); c = (b - B) * 60; C = Math.floor((b - B) * 60); D = Math.floor((c - C) * 60); runtime_span.innerHTML = "网站已运行" + A + "天" + B + "小时" + C + "分" + D + "秒" } show_runtime();</script>
    
    
    <br>
    <span>
        Copyright
        &copy;
        2022-2023
        <a href="https://deemoprobe.github.io/" style="color:#939393;">William&#39;s Blog</a>
        All Rights Reserved
    </span>
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
    document.addEventListener('scroll', function (e) {
        const readProgress = document.getElementById("read_progress");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
    })
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    let mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        (function() {
            document.cookie = "change-themes" + "="+ escape ("false");
        })()

        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    });
</script>

<script>
    document.body.addEventListener('copy', function (e) {
        if (window.getSelection().toString() && window.getSelection().toString().length > 50) {
            let clipboardData = e.clipboardData || window.clipboardData;
            if (clipboardData) {
                e.preventDefault();
                let htmlData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「'+"William's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                let textData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「'+"William's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                clipboardData.setData('text/html', htmlData);
                clipboardData.setData('text/plain', textData);
            }
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;
        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = '📄复制';

        function copyingDone() {
            copybutton.innerText = '👌🏻已复制!';
            setTimeout(() => {
                copybutton.innerText = '📄复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                let text = codeblock.textContent +
                    '\r\n————————————————\r\n' +
                    '版权声明：本文为「'+"William's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                navigator.clipboard.writeText(text);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {}
            selection.removeRange(range);
        });

        let language = codeblock.className.replaceAll("language-", "")
        let macTool = document.createElement("div")
        let macTool1 = document.createElement("div")
        let macTool2 = document.createElement("div")
        let macTool3 = document.createElement("div")
        let languageType = document.createElement("div")
        languageType.innerText = language
        macTool.setAttribute('class', 'mac-tool')
        macTool1.setAttribute('class', 'mac bb1')
        macTool2.setAttribute('class', 'mac bb2')
        macTool3.setAttribute('class', 'mac bb3')
        languageType.setAttribute('class', 'language-type')
        macTool.appendChild(macTool1)
        macTool.appendChild(macTool2)
        macTool.appendChild(macTool3)
        macTool.appendChild(languageType)

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
            container.appendChild(macTool)
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        }
    });
</script>

<script>
    $("code[class^=language] ").on("mouseover", function () {
        if (this.clientWidth < this.scrollWidth) {
            $(this).css("width", "135%")
            $(this).css("border-top-right-radius", "var(--radius)")
        }
    }).on("mouseout", function () {
        $(this).css("width", "100%")
        $(this).css("border-top-right-radius", "unset")
    })
</script>
</body>

</html>
