<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>KubernetesNamespace | William&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Kubernetes Namespace">
<meta name="author" content="deemoprobe">
<link rel="canonical" href="https://deemoprobe.github.io/posts/tech/kubernetes/kubernetesnamespace/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.ddb3ce53f79f05de71d690031b572b6066753a2375de82c18ef290d92427fea4.css" integrity="sha256-3bPOU/efBd5x1pADG1crYGZ1OiN13oLBjvKQ2SQn/qQ=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
        onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://deemoprobe.github.io/img/bear.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://deemoprobe.github.io/img/bear.gif">
<link rel="icon" type="image/png" sizes="32x32" href="https://deemoprobe.github.io/img/bear.gif">
<link rel="apple-touch-icon" href="https://deemoprobe.github.io/img/bear.gif">
<link rel="mask-icon" href="https://deemoprobe.github.io/img/bear.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script defer src="https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js"></script>


<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<meta property="og:title" content="KubernetesNamespace" />
<meta property="og:description" content="Kubernetes Namespace" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://deemoprobe.github.io/posts/tech/kubernetes/kubernetesnamespace/" />
<meta property="og:image" content="https://deemoprobe.github.io/img/kubernetes.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-29T14:21:17+08:00" />
<meta property="article:modified_time" content="2023-04-29T14:21:17+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://deemoprobe.github.io/img/kubernetes.png" />
<meta name="twitter:title" content="KubernetesNamespace"/>
<meta name="twitter:description" content="Kubernetes Namespace"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [

        {
          "@type": "ListItem",
          "position":  1 ,
          "name": "📚文章",
          "item": "https://deemoprobe.github.io/posts/"
        },

        {
          "@type": "ListItem",
          "position":  2 ,
          "name": "👨🏻‍💻 技术",
          "item": "https://deemoprobe.github.io/posts/tech/"
        },

        {
          "@type": "ListItem",
          "position":  3 ,
          "name": "Kubernetes",
          "item": "https://deemoprobe.github.io/posts/tech/kubernetes/"
        }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "KubernetesNamespace",
      "item": "https://deemoprobe.github.io/posts/tech/kubernetes/kubernetesnamespace/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "KubernetesNamespace",
  "name": "KubernetesNamespace",
  "description": "Kubernetes Namespace",
  "keywords": [
    ""
  ],
  "articleBody": "简介 Kubernetes支持多个虚拟集群，这些虚拟集群依赖于同一个物理集群，这些虚拟集群就可以称作namespace（中文习惯称为\"名称空间\"或\"命名空间\", 个人觉得理解成\"作用域\"更为合理一些）\nNamespace有资源隔离的作用，类似Linux系统的多用户的概念（同一物理环境,可以为多用户划分多个相互隔离的操作空间）\nNamespace在多用户之间通过资源配额（resource-quotas）进行集群资源的划分\n使用Namespace # 位于namespace作用域中的资源 [root@k8s-master01 ~]# kubectl api-resources --namespaced NAME SHORTNAMES APIVERSION NAMESPACED KIND bindings v1 true Binding configmaps cm v1 true ConfigMap endpoints ep v1 true Endpoints events ev v1 true Event limitranges limits v1 true LimitRange persistentvolumeclaims pvc v1 true PersistentVolumeClaim pods po v1 true Pod podtemplates v1 true PodTemplate replicationcontrollers rc v1 true ReplicationController resourcequotas quota v1 true ResourceQuota secrets v1 true Secret serviceaccounts sa v1 true ServiceAccount services svc v1 true Service controllerrevisions apps/v1 true ControllerRevision daemonsets ds apps/v1 true DaemonSet deployments deploy apps/v1 true Deployment replicasets rs apps/v1 true ReplicaSet statefulsets sts apps/v1 true StatefulSet localsubjectaccessreviews authorization.k8s.io/v1 true LocalSubjectAccessReview horizontalpodautoscalers hpa autoscaling/v2 true HorizontalPodAutoscaler cronjobs cj batch/v1 true CronJob jobs batch/v1 true Job leases coordination.k8s.io/v1 true Lease networkpolicies crd.projectcalico.org/v1 true NetworkPolicy networksets crd.projectcalico.org/v1 true NetworkSet endpointslices discovery.k8s.io/v1 true EndpointSlice events ev events.k8s.io/v1 true Event pods metrics.k8s.io/v1beta1 true PodMetrics ingresses ing networking.k8s.io/v1 true Ingress networkpolicies netpol networking.k8s.io/v1 true NetworkPolicy poddisruptionbudgets pdb policy/v1 true PodDisruptionBudget rolebindings rbac.authorization.k8s.io/v1 true RoleBinding roles rbac.authorization.k8s.io/v1 true Role csistoragecapacities storage.k8s.io/v1 true CSIStorageCapacity # 不被namespace限制的资源 [root@k8s-master01 ~]# kubectl api-resources --namespaced=false NAME SHORTNAMES APIVERSION NAMESPACED KIND componentstatuses cs v1 false ComponentStatus namespaces ns v1 false Namespace nodes no v1 false Node persistentvolumes pv v1 false PersistentVolume mutatingwebhookconfigurations admissionregistration.k8s.io/v1 false MutatingWebhookConfiguration validatingwebhookconfigurations admissionregistration.k8s.io/v1 false ValidatingWebhookConfiguration customresourcedefinitions crd,crds apiextensions.k8s.io/v1 false CustomResourceDefinition apiservices apiregistration.k8s.io/v1 false APIService tokenreviews authentication.k8s.io/v1 false TokenReview selfsubjectaccessreviews authorization.k8s.io/v1 false SelfSubjectAccessReview selfsubjectrulesreviews authorization.k8s.io/v1 false SelfSubjectRulesReview subjectaccessreviews authorization.k8s.io/v1 false SubjectAccessReview certificatesigningrequests csr certificates.k8s.io/v1 false CertificateSigningRequest bgpconfigurations crd.projectcalico.org/v1 false BGPConfiguration bgppeers crd.projectcalico.org/v1 false BGPPeer blockaffinities crd.projectcalico.org/v1 false BlockAffinity caliconodestatuses crd.projectcalico.org/v1 false CalicoNodeStatus clusterinformations crd.projectcalico.org/v1 false ClusterInformation felixconfigurations crd.projectcalico.org/v1 false FelixConfiguration globalnetworkpolicies crd.projectcalico.org/v1 false GlobalNetworkPolicy globalnetworksets crd.projectcalico.org/v1 false GlobalNetworkSet hostendpoints crd.projectcalico.org/v1 false HostEndpoint ipamblocks crd.projectcalico.org/v1 false IPAMBlock ipamconfigs crd.projectcalico.org/v1 false IPAMConfig ipamhandles crd.projectcalico.org/v1 false IPAMHandle ippools crd.projectcalico.org/v1 false IPPool ipreservations crd.projectcalico.org/v1 false IPReservation kubecontrollersconfigurations crd.projectcalico.org/v1 false KubeControllersConfiguration flowschemas flowcontrol.apiserver.k8s.io/v1beta3 false FlowSchema prioritylevelconfigurations flowcontrol.apiserver.k8s.io/v1beta3 false PriorityLevelConfiguration nodes metrics.k8s.io/v1beta1 false NodeMetrics ingressclasses networking.k8s.io/v1 false IngressClass runtimeclasses node.k8s.io/v1 false RuntimeClass clusterrolebindings rbac.authorization.k8s.io/v1 false ClusterRoleBinding clusterroles rbac.authorization.k8s.io/v1 false ClusterRole priorityclasses pc scheduling.k8s.io/v1 false PriorityClass csidrivers storage.k8s.io/v1 false CSIDriver csinodes storage.k8s.io/v1 false CSINode storageclasses sc storage.k8s.io/v1 false StorageClass volumeattachments storage.k8s.io/v1 false VolumeAttachment 查看Namespace [root@k8s-master01 ~]# kubectl explain namespace | egrep -v \"^\\s*https|^$\" | sed s/\"More info:\"// KIND: Namespace VERSION: v1 DESCRIPTION: Namespace provides a scope for Names. Use of multiple namespaces is optional. FIELDS: apiVersion APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. kind Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. metadata Standard object's metadata. spec Spec defines the behavior of the Namespace. status Status describes the current status of a Namespace. # namespace可简写为ns [root@k8s-master01 ~]# kubectl get ns --show-kind --show-labels NAME STATUS AGE LABELS namespace/default Active 7d kubernetes.io/metadata.name=default namespace/kube-node-lease Active 7d kubernetes.io/metadata.name=kube-node-lease namespace/kube-public Active 7d kubernetes.io/metadata.name=kube-public namespace/kube-system Active 7d kubernetes.io/metadata.name=kube-system 初始状态下，Kubernetes具有四个namespace：\ndefault：默认的namespace，默认用户创建的资源都是在这个namespace下 kube-node-lease：该namespace用于与各个节点相关的租约（Lease）对象；节点租期允许kubelet发送心跳，由此控制面能够检测到节点故障 kube-public：自动创建且所有用户可读的namespace（包括未经身份认证的） kube-system：Kubernetes系统创建的对象所在的namespace # 列出特定的ns [root@k8s-master01 ~]# kubectl get ns kube-public NAME STATUS AGE kube-public Active 7d # 获取特定的ns的描述信息 [root@k8s-master01 ~]# kubectl describe ns kube-public Name: kube-public Labels: kubernetes.io/metadata.name=kube-public Annotations: Status: Active No resource quota. No LimitRange resource. # 如果配置了资源配额，可查看类似下面信息 [root@k8s-master01 ~]# kubectl describe ns quotatest Name: quotatest Labels: kubernetes.io/metadata.name=quotatest Annotations: Status: Active Resource Quotas Name: resource-test Resource Used Hard -------- --- --- pods 1 1 Resource Limits Type Resource Min Max Default Request Default Limit Max Limit/Request Ratio ---- -------- --- --- --------------- ------------- ----------------------- Container cpu 100m 1 500m 1 - Container memory 100Mi 1Gi 256Mi 512Mi - PersistentVolumeClaim storage 1Gi 2Gi - - - 创建和删除 说明：避免使用前缀kube-创建新的namespace，因为它是为Kubernetes系统namespace保留的。\nNamespace命名规则:\n最多63个字符 只能包含字母数字,以及’-' 须以字母或数字开头 须以字母或数字结尾 # 1. yaml文件方式创建 [root@k8s-master01 ~]# vim new_namespace_deemoprobe.yaml apiVersion: v1 kind: Namespace metadata: name: deemoprobe annotations: type: create by yaml [root@k8s-master01 ~]# kubectl apply -f new_namespace_deemoprobe.yaml namespace/deemoprobe created [root@k8s-master01 ~]# kubectl get ns deemoprobe --show-labels --show-kind NAME STATUS AGE LABELS namespace/deemoprobe Active 36s kubernetes.io/metadata.name=deemoprobe # 2. 命令创建 [root@k8s-master01 ~]# kubectl create ns deemoprobe2 namespace/deemoprobe2 created [root@k8s-master01 ~]# kubectl get ns deemoprobe2 --show-labels --show-kind NAME STATUS AGE LABELS namespace/deemoprobe2 Active 12s kubernetes.io/metadata.name=deemoprobe2 # 删除namespace=deemoprobe2 [root@k8s-master01 ~]# kubectl delete ns deemoprobe2 namespace \"deemoprobe2\" deleted [root@k8s-master01 ~]# kubectl get ns deemoprobe2 --show-labels --show-kind Error from server (NotFound): namespaces \"deemoprobe2\" not found # 指定namespace操作其他在namespace作用域中的资源，如kubectl get pods --namespace=deemoprobe # 简写 -n deemoprobe [root@k8s-master01 ~]# kubectl get configmap -n deemoprobe NAME DATA AGE kube-root-ca.crt 1 3m33s 切换默认namespace # 查看当前所在namespace，新集群如果查不到，就是default [root@k8s-master01 ~]# kubectl config view | grep namespace: # 设置当前namespace上下文，使得相应namespace成为默认值 [root@k8s-master01 ~]# kubectl config set-context --current --namespace deemoprobe Context \"kubernetes-admin@kubernetes\" modified. [root@k8s-master01 ~]# kubectl config view | grep namespace: namespace: deemoprobe # 回切 [root@k8s-master01 ~]# kubectl config set-context --current --namespace default Context \"kubernetes-admin@kubernetes\" modified. [root@k8s-master01 ~]# kubectl config view | grep namespace: namespace: default namespace工具 安装namespace管理工具（kubens）更快捷地管理namespace\n[root@k8s-master01 ~]# curl -L https://github.com/ahmetb/kubectx/releases/download/v0.9.4/kubens -o /bin/kubens % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 643 100 643 0 0 163 0 0:00:03 0:00:03 --:--:-- 163 100 5555 100 5555 0 0 638 0 0:00:08 0:00:08 --:--:-- 1704 [root@k8s-master01 ~]# chmod +x /bin/kubens [root@k8s-master01 ~]# kubens -h USAGE: kubens : list the namespaces in the current context kubens : change the active namespace of current context kubens - : switch to the previous namespace in this context kubens -c, --current : show the current namespace kubens -h,--help : show this message # 列出所有namespace， [root@k8s-master01 ~]# kubens deemoprobe default kube-node-lease kube-public kube-system # 查看当前namespace [root@k8s-master01 ~]# kubens -c default # 切换为deemoprobe [root@k8s-master01 ~]# kubens deemoprobe Context \"kubernetes-admin@kubernetes\" modified. Active namespace is \"deemoprobe\". [root@k8s-master01 ~]# kubens -c deemoprobe # 切换为上一个namespace [root@k8s-master01 ~]# kubens - Context \"kubernetes-admin@kubernetes\" modified. Active namespace is \"default\". [root@k8s-master01 ~]# kubens -c default 使用场景 比如：我们需要\"测试\"-“开发”-“生产\"这几个环境，可以划分三个Namespace进行操作，为后续资源配额准备基础环境。\n[root@k8s-master01 ~]# vi namespace.yaml --- apiVersion: v1 kind: Namespace metadata: name: test labels: name: test --- apiVersion: v1 kind: Namespace metadata: name: dev labels: name: dev --- apiVersion: v1 kind: Namespace metadata: name: prod labels: name: prod [root@k8s-master01 ~]# kubectl apply -f namespace.yaml namespace/test created namespace/dev created namespace/prod created [root@k8s-master01 ~]# kubectl get ns --show-labels NAME STATUS AGE LABELS dev Active 64s name=dev prod Active 64s name=prod test Active 65s name=test ... # 全新的Namespace, 未设置任何资源配额和限制 [root@k8s-master01 ~]# kubectl describe ns test Name: test Labels: name=test Annotations: Status: Active No resource quota. No LimitRange resource. [root@k8s-master01 ~]# kubectl describe ns dev Name: dev Labels: name=dev Annotations: Status: Active No resource quota. No LimitRange resource. [root@k8s-master01 ~]# kubectl describe ns prod Name: prod Labels: name=prod Annotations: Status: Active No resource quota. No LimitRange resource. ",
  "wordCount" : "2142",
  "inLanguage": "en",
  "image":"https://deemoprobe.github.io/img/kubernetes.png","datePublished": "2023-04-29T14:21:17+08:00",
  "dateModified": "2023-04-29T14:21:17+08:00",
  "author":[{
    "@type": "Person",
    "name": "deemoprobe"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://deemoprobe.github.io/posts/tech/kubernetes/kubernetesnamespace/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "William's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://deemoprobe.github.io/img/bear.gif"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    (function () {
        let  arr,reg = new RegExp("(^| )"+"change-themes"+"=([^;]*)(;|$)");
        if(arr = document.cookie.match(reg)) {
        } else {
            if (new Date().getHours() >= 19 || new Date().getHours() < 6) {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            }
        }
    })()

    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://deemoprobe.github.io/" accesskey="h" title="William&#39;s Blog (Alt + H)">
            <img src="https://deemoprobe.github.io/img/bear.gif" alt="logo" aria-label="logo"
                 height="35">William&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://deemoprobe.github.io/" title="🏠 主页">
                <span>🏠 主页</span>
                </a>
            </li>
            <li>
                <a href="https://deemoprobe.github.io/tags" title="🎨 标签">
                <span>🎨 标签</span>
                </a>
            </li>
            <li>
                <a href="https://deemoprobe.github.io/archives/" title="📈 归档">
                <span>📈 归档</span>
                </a>
            </li>
            <li>
                <a href="https://deemoprobe.github.io/tools" title="🪁 工具">
                <span>🪁 工具</span>
                </a>
            </li>
            <li>
                <a href="https://deemoprobe.github.io/search" title="🔍 搜索 (Alt &#43; /)" accesskey=/>
                <span>🔍 搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }
</style>

<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            
            <h1 class="post-title">
                KubernetesNamespace
            </h1>
            <div class="post-description">
                Kubernetes Namespace
            </div>
            <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2023-04-29
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>2142字
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>5分钟
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>deemoprobe
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="https://deemoprobe.github.io/tags/kubernetes/" style="color: var(--secondary)!important;">kubernetes</a>
            </span>
        </span>
    </span>
</span>
<span style="opacity: 0.8;">
                    <span id="post_meta_style_7">
                        &nbsp;&nbsp;
                        <span class="fa fa-eye" ></span>
                        <span>
                            <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                            &nbsp;&nbsp;
                        </span>
                    </span>
                    
                </span>

</div>
        </header> 
<figure class="entry-cover1"><img style="zoom:;" loading="lazy" src="https://deemoprobe.github.io/img/kubernetes.png" alt="">
    
</figure><aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">文章目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e7%ae%80%e4%bb%8b" aria-label="简介">简介</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8namespace" aria-label="使用Namespace">使用Namespace</a><ul>
                        
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8bnamespace" aria-label="查看Namespace">查看Namespace</a></li>
                <li>
                    <a href="#%e5%88%9b%e5%bb%ba%e5%92%8c%e5%88%a0%e9%99%a4" aria-label="创建和删除">创建和删除</a></li>
                <li>
                    <a href="#%e5%88%87%e6%8d%a2%e9%bb%98%e8%ae%a4namespace" aria-label="切换默认namespace">切换默认namespace</a></li>
                <li>
                    <a href="#namespace%e5%b7%a5%e5%85%b7" aria-label="namespace工具">namespace工具</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e5%9c%ba%e6%99%af" aria-label="使用场景">使用场景</a>
                </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
            const id = encodeURI(element.getAttribute('id')).toLowerCase();
            if (element === activeElement){
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
            } else {
                document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
            }
        })
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
        <div class="post-content"><h2 id="简介">简介<a hidden class="anchor" aria-hidden="true" href="#简介">#</a></h2>
<p>Kubernetes支持多个虚拟集群，这些虚拟集群依赖于同一个物理集群，这些虚拟集群就可以称作<code>namespace</code>（中文习惯称为&quot;名称空间&quot;或&quot;命名空间&quot;, 个人觉得理解成&quot;作用域&quot;更为合理一些）</p>
<p>Namespace有资源隔离的作用，类似Linux系统的<code>多用户</code>的概念（同一物理环境,可以为多用户划分多个相互隔离的操作空间）</p>
<p>Namespace在多用户之间通过<code>资源配额（resource-quotas）</code>进行集群资源的划分</p>
<h2 id="使用namespace">使用Namespace<a hidden class="anchor" aria-hidden="true" href="#使用namespace">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 位于namespace作用域中的资源</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl api-resources --namespaced</span>
</span></span><span style="display:flex;"><span>NAME                        SHORTNAMES   APIVERSION                     NAMESPACED   KIND
</span></span><span style="display:flex;"><span>bindings                                 v1                             true         Binding
</span></span><span style="display:flex;"><span>configmaps                  cm           v1                             true         ConfigMap
</span></span><span style="display:flex;"><span>endpoints                   ep           v1                             true         Endpoints
</span></span><span style="display:flex;"><span>events                      ev           v1                             true         Event
</span></span><span style="display:flex;"><span>limitranges                 limits       v1                             true         LimitRange
</span></span><span style="display:flex;"><span>persistentvolumeclaims      pvc          v1                             true         PersistentVolumeClaim
</span></span><span style="display:flex;"><span>pods                        po           v1                             true         Pod
</span></span><span style="display:flex;"><span>podtemplates                             v1                             true         PodTemplate
</span></span><span style="display:flex;"><span>replicationcontrollers      rc           v1                             true         ReplicationController
</span></span><span style="display:flex;"><span>resourcequotas              quota        v1                             true         ResourceQuota
</span></span><span style="display:flex;"><span>secrets                                  v1                             true         Secret
</span></span><span style="display:flex;"><span>serviceaccounts             sa           v1                             true         ServiceAccount
</span></span><span style="display:flex;"><span>services                    svc          v1                             true         Service
</span></span><span style="display:flex;"><span>controllerrevisions                      apps/v1                        true         ControllerRevision
</span></span><span style="display:flex;"><span>daemonsets                  ds           apps/v1                        true         DaemonSet
</span></span><span style="display:flex;"><span>deployments                 deploy       apps/v1                        true         Deployment
</span></span><span style="display:flex;"><span>replicasets                 rs           apps/v1                        true         ReplicaSet
</span></span><span style="display:flex;"><span>statefulsets                sts          apps/v1                        true         StatefulSet
</span></span><span style="display:flex;"><span>localsubjectaccessreviews                authorization.k8s.io/v1        true         LocalSubjectAccessReview
</span></span><span style="display:flex;"><span>horizontalpodautoscalers    hpa          autoscaling/v2                 true         HorizontalPodAutoscaler
</span></span><span style="display:flex;"><span>cronjobs                    cj           batch/v1                       true         CronJob
</span></span><span style="display:flex;"><span>jobs                                     batch/v1                       true         Job
</span></span><span style="display:flex;"><span>leases                                   coordination.k8s.io/v1         true         Lease
</span></span><span style="display:flex;"><span>networkpolicies                          crd.projectcalico.org/v1       true         NetworkPolicy
</span></span><span style="display:flex;"><span>networksets                              crd.projectcalico.org/v1       true         NetworkSet
</span></span><span style="display:flex;"><span>endpointslices                           discovery.k8s.io/v1            true         EndpointSlice
</span></span><span style="display:flex;"><span>events                      ev           events.k8s.io/v1               true         Event
</span></span><span style="display:flex;"><span>pods                                     metrics.k8s.io/v1beta1         true         PodMetrics
</span></span><span style="display:flex;"><span>ingresses                   ing          networking.k8s.io/v1           true         Ingress
</span></span><span style="display:flex;"><span>networkpolicies             netpol       networking.k8s.io/v1           true         NetworkPolicy
</span></span><span style="display:flex;"><span>poddisruptionbudgets        pdb          policy/v1                      true         PodDisruptionBudget
</span></span><span style="display:flex;"><span>rolebindings                             rbac.authorization.k8s.io/v1   true         RoleBinding
</span></span><span style="display:flex;"><span>roles                                    rbac.authorization.k8s.io/v1   true         Role
</span></span><span style="display:flex;"><span>csistoragecapacities                     storage.k8s.io/v1              true         CSIStorageCapacity
</span></span></code></pre></div><p><img loading="lazy" src="https://deemoprobe.oss-cn-shanghai.aliyuncs.com/images/20220313143057.png" alt="1"  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 不被namespace限制的资源</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl api-resources --namespaced=false</span>
</span></span><span style="display:flex;"><span>NAME                              SHORTNAMES   APIVERSION                             NAMESPACED   KIND
</span></span><span style="display:flex;"><span>componentstatuses                 cs           v1                                     false        ComponentStatus
</span></span><span style="display:flex;"><span>namespaces                        ns           v1                                     false        Namespace
</span></span><span style="display:flex;"><span>nodes                             no           v1                                     false        Node
</span></span><span style="display:flex;"><span>persistentvolumes                 pv           v1                                     false        PersistentVolume
</span></span><span style="display:flex;"><span>mutatingwebhookconfigurations                  admissionregistration.k8s.io/v1        false        MutatingWebhookConfiguration
</span></span><span style="display:flex;"><span>validatingwebhookconfigurations                admissionregistration.k8s.io/v1        false        ValidatingWebhookConfiguration
</span></span><span style="display:flex;"><span>customresourcedefinitions         crd,crds     apiextensions.k8s.io/v1                false        CustomResourceDefinition
</span></span><span style="display:flex;"><span>apiservices                                    apiregistration.k8s.io/v1              false        APIService
</span></span><span style="display:flex;"><span>tokenreviews                                   authentication.k8s.io/v1               false        TokenReview
</span></span><span style="display:flex;"><span>selfsubjectaccessreviews                       authorization.k8s.io/v1                false        SelfSubjectAccessReview
</span></span><span style="display:flex;"><span>selfsubjectrulesreviews                        authorization.k8s.io/v1                false        SelfSubjectRulesReview
</span></span><span style="display:flex;"><span>subjectaccessreviews                           authorization.k8s.io/v1                false        SubjectAccessReview
</span></span><span style="display:flex;"><span>certificatesigningrequests        csr          certificates.k8s.io/v1                 false        CertificateSigningRequest
</span></span><span style="display:flex;"><span>bgpconfigurations                              crd.projectcalico.org/v1               false        BGPConfiguration
</span></span><span style="display:flex;"><span>bgppeers                                       crd.projectcalico.org/v1               false        BGPPeer
</span></span><span style="display:flex;"><span>blockaffinities                                crd.projectcalico.org/v1               false        BlockAffinity
</span></span><span style="display:flex;"><span>caliconodestatuses                             crd.projectcalico.org/v1               false        CalicoNodeStatus
</span></span><span style="display:flex;"><span>clusterinformations                            crd.projectcalico.org/v1               false        ClusterInformation
</span></span><span style="display:flex;"><span>felixconfigurations                            crd.projectcalico.org/v1               false        FelixConfiguration
</span></span><span style="display:flex;"><span>globalnetworkpolicies                          crd.projectcalico.org/v1               false        GlobalNetworkPolicy
</span></span><span style="display:flex;"><span>globalnetworksets                              crd.projectcalico.org/v1               false        GlobalNetworkSet
</span></span><span style="display:flex;"><span>hostendpoints                                  crd.projectcalico.org/v1               false        HostEndpoint
</span></span><span style="display:flex;"><span>ipamblocks                                     crd.projectcalico.org/v1               false        IPAMBlock
</span></span><span style="display:flex;"><span>ipamconfigs                                    crd.projectcalico.org/v1               false        IPAMConfig
</span></span><span style="display:flex;"><span>ipamhandles                                    crd.projectcalico.org/v1               false        IPAMHandle
</span></span><span style="display:flex;"><span>ippools                                        crd.projectcalico.org/v1               false        IPPool
</span></span><span style="display:flex;"><span>ipreservations                                 crd.projectcalico.org/v1               false        IPReservation
</span></span><span style="display:flex;"><span>kubecontrollersconfigurations                  crd.projectcalico.org/v1               false        KubeControllersConfiguration
</span></span><span style="display:flex;"><span>flowschemas                                    flowcontrol.apiserver.k8s.io/v1beta3   false        FlowSchema
</span></span><span style="display:flex;"><span>prioritylevelconfigurations                    flowcontrol.apiserver.k8s.io/v1beta3   false        PriorityLevelConfiguration
</span></span><span style="display:flex;"><span>nodes                                          metrics.k8s.io/v1beta1                 false        NodeMetrics
</span></span><span style="display:flex;"><span>ingressclasses                                 networking.k8s.io/v1                   false        IngressClass
</span></span><span style="display:flex;"><span>runtimeclasses                                 node.k8s.io/v1                         false        RuntimeClass
</span></span><span style="display:flex;"><span>clusterrolebindings                            rbac.authorization.k8s.io/v1           false        ClusterRoleBinding
</span></span><span style="display:flex;"><span>clusterroles                                   rbac.authorization.k8s.io/v1           false        ClusterRole
</span></span><span style="display:flex;"><span>priorityclasses                   pc           scheduling.k8s.io/v1                   false        PriorityClass
</span></span><span style="display:flex;"><span>csidrivers                                     storage.k8s.io/v1                      false        CSIDriver
</span></span><span style="display:flex;"><span>csinodes                                       storage.k8s.io/v1                      false        CSINode
</span></span><span style="display:flex;"><span>storageclasses                    sc           storage.k8s.io/v1                      false        StorageClass
</span></span><span style="display:flex;"><span>volumeattachments                              storage.k8s.io/v1                      false        VolumeAttachment
</span></span></code></pre></div><p><img loading="lazy" src="https://deemoprobe.oss-cn-shanghai.aliyuncs.com/images/20220313143135.png" alt="2"  />
</p>
<h3 id="查看namespace">查看Namespace<a hidden class="anchor" aria-hidden="true" href="#查看namespace">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl explain namespace | egrep -v &#34;^\s*https|^$&#34; | sed s/&#34;More info:&#34;//</span>
</span></span><span style="display:flex;"><span>KIND:     Namespace
</span></span><span style="display:flex;"><span>VERSION:  v1
</span></span><span style="display:flex;"><span>DESCRIPTION:
</span></span><span style="display:flex;"><span>     Namespace provides a scope <span style="color:#66d9ef">for</span> Names. Use of multiple namespaces is
</span></span><span style="display:flex;"><span>     optional.
</span></span><span style="display:flex;"><span>FIELDS:
</span></span><span style="display:flex;"><span>   apiVersion   &lt;string&gt;
</span></span><span style="display:flex;"><span>     APIVersion defines the versioned schema of this representation of an
</span></span><span style="display:flex;"><span>     object. Servers should convert recognized schemas to the latest internal
</span></span><span style="display:flex;"><span>     value, and may reject unrecognized values.
</span></span><span style="display:flex;"><span>   kind &lt;string&gt;
</span></span><span style="display:flex;"><span>     Kind is a string value representing the REST resource this object
</span></span><span style="display:flex;"><span>     represents. Servers may infer this from the endpoint the client submits
</span></span><span style="display:flex;"><span>     requests to. Cannot be updated. In CamelCase.
</span></span><span style="display:flex;"><span>   metadata     &lt;Object&gt;
</span></span><span style="display:flex;"><span>     Standard object<span style="color:#960050;background-color:#1e0010">&#39;</span>s metadata.
</span></span><span style="display:flex;"><span>   spec &lt;Object&gt;
</span></span><span style="display:flex;"><span>     Spec defines the behavior of the Namespace.
</span></span><span style="display:flex;"><span>   status       &lt;Object&gt;
</span></span><span style="display:flex;"><span>     Status describes the current status of a Namespace.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># namespace可简写为ns</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl get ns --show-kind --show-labels </span>
</span></span><span style="display:flex;"><span>NAME                             STATUS   AGE     LABELS
</span></span><span style="display:flex;"><span>namespace/default                Active   7d      kubernetes.io/metadata.name<span style="color:#f92672">=</span>default
</span></span><span style="display:flex;"><span>namespace/kube-node-lease        Active   7d      kubernetes.io/metadata.name<span style="color:#f92672">=</span>kube-node-lease
</span></span><span style="display:flex;"><span>namespace/kube-public            Active   7d      kubernetes.io/metadata.name<span style="color:#f92672">=</span>kube-public
</span></span><span style="display:flex;"><span>namespace/kube-system            Active   7d      kubernetes.io/metadata.name<span style="color:#f92672">=</span>kube-system
</span></span></code></pre></div><p>初始状态下，Kubernetes具有四个namespace：</p>
<ul>
<li>default：默认的namespace，默认用户创建的资源都是在这个namespace下</li>
<li>kube-node-lease：该namespace用于与各个节点相关的租约（Lease）对象；节点租期允许kubelet发送心跳，由此控制面能够检测到节点故障</li>
<li>kube-public：自动创建且所有用户可读的namespace（包括未经身份认证的）</li>
<li>kube-system：Kubernetes系统创建的对象所在的namespace</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 列出特定的ns</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl get ns kube-public </span>
</span></span><span style="display:flex;"><span>NAME          STATUS   AGE
</span></span><span style="display:flex;"><span>kube-public   Active   7d
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 获取特定的ns的描述信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl describe ns kube-public </span>
</span></span><span style="display:flex;"><span>Name:         kube-public
</span></span><span style="display:flex;"><span>Labels:       kubernetes.io/metadata.name<span style="color:#f92672">=</span>kube-public
</span></span><span style="display:flex;"><span>Annotations:  &lt;none&gt;
</span></span><span style="display:flex;"><span>Status:       Active
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>No resource quota.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>No LimitRange resource.
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 如果配置了资源配额，可查看类似下面信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl describe ns quotatest </span>
</span></span><span style="display:flex;"><span>Name:         quotatest
</span></span><span style="display:flex;"><span>Labels:       kubernetes.io/metadata.name<span style="color:#f92672">=</span>quotatest
</span></span><span style="display:flex;"><span>Annotations:  &lt;none&gt;
</span></span><span style="display:flex;"><span>Status:       Active
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Resource Quotas
</span></span><span style="display:flex;"><span>  Name:     resource-test
</span></span><span style="display:flex;"><span>  Resource  Used  Hard
</span></span><span style="display:flex;"><span>  --------  ---   ---
</span></span><span style="display:flex;"><span>  pods      <span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Resource Limits
</span></span><span style="display:flex;"><span> Type                   Resource  Min    Max  Default Request  Default Limit  Max Limit/Request Ratio
</span></span><span style="display:flex;"><span> ----                   --------  ---    ---  ---------------  -------------  -----------------------
</span></span><span style="display:flex;"><span> Container              cpu       100m   <span style="color:#ae81ff">1</span>    500m             <span style="color:#ae81ff">1</span>              -
</span></span><span style="display:flex;"><span> Container              memory    100Mi  1Gi  256Mi            512Mi          -
</span></span><span style="display:flex;"><span> PersistentVolumeClaim  storage   1Gi    2Gi  -                -              -
</span></span></code></pre></div><h3 id="创建和删除">创建和删除<a hidden class="anchor" aria-hidden="true" href="#创建和删除">#</a></h3>
<blockquote>
<p>说明：避免使用前缀<code>kube-</code>创建新的namespace，因为它是为Kubernetes系统namespace保留的。</p>
</blockquote>
<p>Namespace命名规则:</p>
<ul>
<li>最多63个字符</li>
<li>只能包含字母数字,以及&rsquo;-'</li>
<li>须以字母或数字开头</li>
<li>须以字母或数字结尾</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 1. yaml文件方式创建</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># vim new_namespace_deemoprobe.yaml </span>
</span></span><span style="display:flex;"><span>apiVersion: v1
</span></span><span style="display:flex;"><span>kind: Namespace
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: deemoprobe
</span></span><span style="display:flex;"><span>  annotations:
</span></span><span style="display:flex;"><span>    type: create by yaml
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl apply -f new_namespace_deemoprobe.yaml </span>
</span></span><span style="display:flex;"><span>namespace/deemoprobe created
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl get ns deemoprobe --show-labels --show-kind </span>
</span></span><span style="display:flex;"><span>NAME                   STATUS   AGE   LABELS
</span></span><span style="display:flex;"><span>namespace/deemoprobe   Active   36s   kubernetes.io/metadata.name<span style="color:#f92672">=</span>deemoprobe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. 命令创建</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl create ns deemoprobe2</span>
</span></span><span style="display:flex;"><span>namespace/deemoprobe2 created
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl get ns deemoprobe2 --show-labels --show-kind </span>
</span></span><span style="display:flex;"><span>NAME                    STATUS   AGE   LABELS
</span></span><span style="display:flex;"><span>namespace/deemoprobe2   Active   12s   kubernetes.io/metadata.name<span style="color:#f92672">=</span>deemoprobe2
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除namespace=deemoprobe2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl delete ns deemoprobe2</span>
</span></span><span style="display:flex;"><span>namespace <span style="color:#e6db74">&#34;deemoprobe2&#34;</span> deleted
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl get ns deemoprobe2 --show-labels --show-kind </span>
</span></span><span style="display:flex;"><span>Error from server <span style="color:#f92672">(</span>NotFound<span style="color:#f92672">)</span>: namespaces <span style="color:#e6db74">&#34;deemoprobe2&#34;</span> not found
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 指定namespace操作其他在namespace作用域中的资源，如kubectl get pods --namespace=deemoprobe</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 简写 -n deemoprobe</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl get configmap -n deemoprobe </span>
</span></span><span style="display:flex;"><span>NAME               DATA   AGE
</span></span><span style="display:flex;"><span>kube-root-ca.crt   <span style="color:#ae81ff">1</span>      3m33s
</span></span></code></pre></div><h3 id="切换默认namespace">切换默认namespace<a hidden class="anchor" aria-hidden="true" href="#切换默认namespace">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 查看当前所在namespace，新集群如果查不到，就是default</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl config view | grep namespace:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置当前namespace上下文，使得相应namespace成为默认值</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl config set-context --current --namespace deemoprobe</span>
</span></span><span style="display:flex;"><span>Context <span style="color:#e6db74">&#34;kubernetes-admin@kubernetes&#34;</span> modified.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl config view | grep namespace:</span>
</span></span><span style="display:flex;"><span>    namespace: deemoprobe
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 回切</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl config set-context --current --namespace default</span>
</span></span><span style="display:flex;"><span>Context <span style="color:#e6db74">&#34;kubernetes-admin@kubernetes&#34;</span> modified.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl config view | grep namespace:</span>
</span></span><span style="display:flex;"><span>    namespace: default
</span></span></code></pre></div><h3 id="namespace工具">namespace工具<a hidden class="anchor" aria-hidden="true" href="#namespace工具">#</a></h3>
<p>安装namespace管理工具（kubens）更快捷地管理namespace</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># curl -L https://github.com/ahmetb/kubectx/releases/download/v0.9.4/kubens -o /bin/kubens</span>
</span></span><span style="display:flex;"><span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span style="display:flex;"><span>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100</span>   <span style="color:#ae81ff">643</span>  <span style="color:#ae81ff">100</span>   <span style="color:#ae81ff">643</span>    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">163</span>      <span style="color:#ae81ff">0</span>  0:00:03  0:00:03 --:--:--   <span style="color:#ae81ff">163</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100</span>  <span style="color:#ae81ff">5555</span>  <span style="color:#ae81ff">100</span>  <span style="color:#ae81ff">5555</span>    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">638</span>      <span style="color:#ae81ff">0</span>  0:00:08  0:00:08 --:--:--  <span style="color:#ae81ff">1704</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># chmod +x /bin/kubens </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubens -h</span>
</span></span><span style="display:flex;"><span>USAGE:
</span></span><span style="display:flex;"><span>  kubens                    : list the namespaces in the current context
</span></span><span style="display:flex;"><span>  kubens &lt;NAME&gt;             : change the active namespace of current context
</span></span><span style="display:flex;"><span>  kubens -                  : switch to the previous namespace in this context
</span></span><span style="display:flex;"><span>  kubens -c, --current      : show the current namespace
</span></span><span style="display:flex;"><span>  kubens -h,--help          : show this message
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 列出所有namespace，</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubens</span>
</span></span><span style="display:flex;"><span>deemoprobe
</span></span><span style="display:flex;"><span>default
</span></span><span style="display:flex;"><span>kube-node-lease
</span></span><span style="display:flex;"><span>kube-public
</span></span><span style="display:flex;"><span>kube-system
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看当前namespace</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubens -c</span>
</span></span><span style="display:flex;"><span>default
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 切换为deemoprobe</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubens deemoprobe</span>
</span></span><span style="display:flex;"><span>Context <span style="color:#e6db74">&#34;kubernetes-admin@kubernetes&#34;</span> modified.
</span></span><span style="display:flex;"><span>Active namespace is <span style="color:#e6db74">&#34;deemoprobe&#34;</span>.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubens -c</span>
</span></span><span style="display:flex;"><span>deemoprobe
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 切换为上一个namespace</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubens -</span>
</span></span><span style="display:flex;"><span>Context <span style="color:#e6db74">&#34;kubernetes-admin@kubernetes&#34;</span> modified.
</span></span><span style="display:flex;"><span>Active namespace is <span style="color:#e6db74">&#34;default&#34;</span>.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubens -c</span>
</span></span><span style="display:flex;"><span>default
</span></span></code></pre></div><h2 id="使用场景">使用场景<a hidden class="anchor" aria-hidden="true" href="#使用场景">#</a></h2>
<p>比如：我们需要&quot;测试&quot;-&ldquo;开发&rdquo;-&ldquo;生产&quot;这几个环境，可以划分三个Namespace进行操作，为后续资源配额准备基础环境。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># vi namespace.yaml </span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>apiVersion: v1
</span></span><span style="display:flex;"><span>kind: Namespace
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: test
</span></span><span style="display:flex;"><span>  labels:
</span></span><span style="display:flex;"><span>    name: test
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>apiVersion: v1
</span></span><span style="display:flex;"><span>kind: Namespace
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: dev
</span></span><span style="display:flex;"><span>  labels:
</span></span><span style="display:flex;"><span>    name: dev
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>apiVersion: v1
</span></span><span style="display:flex;"><span>kind: Namespace
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>  name: prod
</span></span><span style="display:flex;"><span>  labels:
</span></span><span style="display:flex;"><span>    name: prod
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl apply -f namespace.yaml </span>
</span></span><span style="display:flex;"><span>namespace/test created
</span></span><span style="display:flex;"><span>namespace/dev created
</span></span><span style="display:flex;"><span>namespace/prod created
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl get ns --show-labels</span>
</span></span><span style="display:flex;"><span>NAME              STATUS   AGE   LABELS
</span></span><span style="display:flex;"><span>dev               Active   64s   name<span style="color:#f92672">=</span>dev
</span></span><span style="display:flex;"><span>prod              Active   64s   name<span style="color:#f92672">=</span>prod
</span></span><span style="display:flex;"><span>test              Active   65s   name<span style="color:#f92672">=</span>test
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 全新的Namespace, 未设置任何资源配额和限制</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl describe ns test</span>
</span></span><span style="display:flex;"><span>Name:         test
</span></span><span style="display:flex;"><span>Labels:       name<span style="color:#f92672">=</span>test
</span></span><span style="display:flex;"><span>Annotations:  &lt;none&gt;
</span></span><span style="display:flex;"><span>Status:       Active
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>No resource quota.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>No LimitRange resource.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl describe ns dev</span>
</span></span><span style="display:flex;"><span>Name:         dev
</span></span><span style="display:flex;"><span>Labels:       name<span style="color:#f92672">=</span>dev
</span></span><span style="display:flex;"><span>Annotations:  &lt;none&gt;
</span></span><span style="display:flex;"><span>Status:       Active
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>No resource quota.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>No LimitRange resource.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@k8s-master01 ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl describe ns prod</span>
</span></span><span style="display:flex;"><span>Name:         prod
</span></span><span style="display:flex;"><span>Labels:       name<span style="color:#f92672">=</span>prod
</span></span><span style="display:flex;"><span>Annotations:  &lt;none&gt;
</span></span><span style="display:flex;"><span>Status:       Active
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>No resource quota.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>No LimitRange resource.
</span></span></code></pre></div>

        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="prev" href="https://deemoprobe.github.io/posts/tech/kubernetes/kubernetespod/">
    <span class="title">« 上一页</span>
    <br>
    <span>KubernetesPod</span>
  </a>
  <a class="next" href="https://deemoprobe.github.io/posts/tech/kubernetes/kubernetescli/">
    <span class="title">下一页 »</span>
    <br>
    <span>Kuberntes CLI</span>
  </a>
</nav>

        </footer>
    </div>
</article>
</main>

<footer class="footer">
    
        <span id="runtime_span"></span>
        <script
            type="text/javascript">function show_runtime() { window.setTimeout("show_runtime()", 1000); X = new Date("1/1/2023 1:00:00"); Y = new Date(); T = (Y.getTime() - X.getTime()); M = 24 * 60 * 60 * 1000; a = T / M; A = Math.floor(a); b = (a - A) * 24; B = Math.floor(b); c = (b - B) * 60; C = Math.floor((b - B) * 60); D = Math.floor((c - C) * 60); runtime_span.innerHTML = "网站已运行" + A + "天" + B + "小时" + C + "分" + D + "秒" } show_runtime();</script>
    
    
    <br>
    <span>
        Copyright
        &copy;
        2022-2023
        <a href="https://deemoprobe.github.io/" style="color:#939393;">William&#39;s Blog</a>
        All Rights Reserved
    </span>
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <span class="topInner">
        <svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z"/>
        </svg>
        <span id="read_progress"></span>
    </span>
</a>

<script>
    document.addEventListener('scroll', function (e) {
        const readProgress = document.getElementById("read_progress");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        readProgress.innerText = ((scrollTop / (scrollHeight - clientHeight)).toFixed(2) * 100).toFixed(0);
    })
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    let mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        (function() {
            document.cookie = "change-themes" + "="+ escape ("false");
        })()

        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    });
</script>

<script>
    document.body.addEventListener('copy', function (e) {
        if (window.getSelection().toString() && window.getSelection().toString().length > 50) {
            let clipboardData = e.clipboardData || window.clipboardData;
            if (clipboardData) {
                e.preventDefault();
                let htmlData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「'+"William's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                let textData = window.getSelection().toString() +
                    '\r\n\n————————————————\r\n' +
                    '版权声明：本文为「'+"William's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                clipboardData.setData('text/html', htmlData);
                clipboardData.setData('text/plain', textData);
            }
        }
    });
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;
        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = '📄复制';

        function copyingDone() {
            copybutton.innerText = '👌🏻已复制!';
            setTimeout(() => {
                copybutton.innerText = '📄复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                let text = codeblock.textContent +
                    '\r\n————————————————\r\n' +
                    '版权声明：本文为「'+"William's Blog"+'」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。' +
                '\r\n原文链接：' + location.href;
                navigator.clipboard.writeText(text);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {}
            selection.removeRange(range);
        });

        let language = codeblock.className.replaceAll("language-", "")
        let macTool = document.createElement("div")
        let macTool1 = document.createElement("div")
        let macTool2 = document.createElement("div")
        let macTool3 = document.createElement("div")
        let languageType = document.createElement("div")
        languageType.innerText = language
        macTool.setAttribute('class', 'mac-tool')
        macTool1.setAttribute('class', 'mac bb1')
        macTool2.setAttribute('class', 'mac bb2')
        macTool3.setAttribute('class', 'mac bb3')
        languageType.setAttribute('class', 'language-type')
        macTool.appendChild(macTool1)
        macTool.appendChild(macTool2)
        macTool.appendChild(macTool3)
        macTool.appendChild(languageType)

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
            container.appendChild(macTool)
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
            container.appendChild(macTool)
        }
    });
</script>

<script>
    $("code[class^=language] ").on("mouseover", function () {
        if (this.clientWidth < this.scrollWidth) {
            $(this).css("width", "135%")
            $(this).css("border-top-right-radius", "var(--radius)")
        }
    }).on("mouseout", function () {
        $(this).css("width", "100%")
        $(this).css("border-top-right-radius", "unset")
    })
</script>
</body>

</html>
